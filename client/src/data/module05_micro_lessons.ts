// ============================================================
// AMD Linux Driver Learning Platform - Module 0.5 Micro-Lessons
// Module 0.5: AMD Ecosystem Overview (AMD ç”Ÿæ€ç³»ç»Ÿæ¦‚è§ˆ)
// 5 lessons in 2 groups, ~20 min each, total ~100 min
// ============================================================
import type { MicroLessonModule } from './micro_lesson_types';

export const module05MicroLessons: MicroLessonModule = {
  moduleId: 'ecosystem',
  groups: [
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Group 0.5.1: AMD Products & Naming
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      id: '05-1',
      number: '0.5.1',
      title: 'AMD äº§å“çº¿ä¸å‘½åè§„åˆ™',
      titleEn: 'AMD Products & Naming',
      icon: 'ğŸ¢',
      description: 'ç†è§£ AMD çš„å…¬å¸ç»“æ„ã€GPU äº§å“å±‚æ¬¡ã€å‘½åè§„åˆ™ï¼Œä»¥åŠå¦‚ä½•ä»ä¸€ä¸ªå‹å·æ¨æ–­å‡ºå®ƒåœ¨å†…æ ¸ä»£ç ä¸­å¯¹åº”çš„èŠ¯ç‰‡ä»£å·å’Œ IP ç‰ˆæœ¬ã€‚',
      lessons: [
        // â”€â”€ Lesson 0.5.1.1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        {
          id: '05-1-1',
          number: '0.5.1.1',
          title: 'AMD GPU äº§å“çº¿å±‚æ¬¡ï¼šä» Radeon RX åˆ° Instinct MI',
          titleEn: 'AMD GPU Product Hierarchy',
          duration: 20,
          difficulty: 'beginner',
          tags: ['AMD', 'Radeon', 'Instinct', 'product-line'],
          concept: {
            summary: 'AMD GPU äº§å“åˆ†ä¸‰ä¸ªå±‚æ¬¡ï¼šæ¶ˆè´¹çº§ Radeon RXï¼ˆæ¸¸æˆï¼‰ã€ä¸“ä¸šçº§ Radeon Proï¼ˆå·¥ä½œç«™ï¼‰ã€æ•°æ®ä¸­å¿ƒçº§ Instinct MIï¼ˆAI/HPCï¼‰ã€‚å®ƒä»¬å…±äº«åŒä¸€ä¸ª amdgpu å†…æ ¸é©±åŠ¨ï¼Œä½†å›ºä»¶å’Œç”¨æˆ·æ€é…ç½®ä¸åŒã€‚',
            explanation: [
              'AMD çš„ GPU ä¸šåŠ¡ç”± Radeon Technologies Group (RTG) è´Ÿè´£ï¼Œäº§å“çº¿åˆ†ä¸ºä¸‰ä¸ªæ˜ç¡®çš„å±‚æ¬¡ã€‚ç†è§£è¿™ä¸ªåˆ†å±‚å¯¹é©±åŠ¨å¼€å‘è€…è‡³å…³é‡è¦â€”â€”å› ä¸ºåŒä¸€ä¸ª amdgpu å†…æ ¸é©±åŠ¨éœ€è¦æ”¯æŒæ‰€æœ‰ä¸‰ä¸ªå±‚æ¬¡çš„äº§å“ï¼Œè€Œæ¯ä¸ªå±‚æ¬¡çš„ä¼˜åŒ–ç›®æ ‡å’ŒåŠŸèƒ½éœ€æ±‚æˆªç„¶ä¸åŒã€‚',
              'æ¶ˆè´¹çº§ Radeon RXï¼šé¢å‘æ¸¸æˆç©å®¶å’Œåˆ›æ„å·¥ä½œè€…çš„äº§å“çº¿ï¼ˆæœ¬æ•™ç¨‹ä»¥ RX 7600 XT ä¸ºç¤ºä¾‹ï¼‰ã€‚ä¸»è¦é¢å‘æ¸¸æˆç©å®¶å’Œåˆ›æ„å·¥ä½œè€…ã€‚é©±åŠ¨ä¼˜åŒ–çš„é‡ç‚¹æ˜¯ OpenGL/Vulkan æ¸²æŸ“æ€§èƒ½ã€ä½å»¶è¿Ÿæ˜¾ç¤ºè¾“å‡ºï¼ˆFreeSyncï¼‰ã€è§†é¢‘ç¼–è§£ç ï¼ˆVCN å¼•æ“ï¼‰ã€‚åœ¨å†…æ ¸ä»£ç ä¸­ï¼ŒRadeon RX ç³»åˆ—é€šè¿‡æ ‡å‡†çš„ /dev/dri/card0 DRM æ¥å£æš´éœ²åŠŸèƒ½ã€‚ä»·æ ¼èŒƒå›´ï¼š$200-$1200ã€‚',
              'ä¸“ä¸šçº§ Radeon Proï¼šé¢å‘ CAD è®¾è®¡å¸ˆã€å½±è§†åæœŸã€ç§‘å­¦å¯è§†åŒ–ç­‰ä¸“ä¸šåœºæ™¯ã€‚ä¸æ¶ˆè´¹çº§ä½¿ç”¨ç›¸åŒçš„ GPU èŠ¯ç‰‡ï¼ˆå¦‚ Pro W7900 ä½¿ç”¨ Navi31ï¼Œå’Œ RX 7900 XTX åŒèŠ¯ç‰‡ï¼‰ï¼Œä½†å›ºä»¶é…ç½®ä¸åŒï¼šï¼ˆ1ï¼‰é©±åŠ¨ç»è¿‡ä¸“ä¸šåº”ç”¨è®¤è¯ï¼ˆå¦‚ SolidWorksã€Mayaï¼‰ï¼›ï¼ˆ2ï¼‰ECC æ˜¾å­˜æ”¯æŒï¼ˆé”™è¯¯æ ¡æ­£ï¼Œé˜²æ­¢æ•°æ®æŸåï¼‰ï¼›ï¼ˆ3ï¼‰æ›´ä¿å®ˆçš„é¢‘ç‡è®¾ç½®ä»¥ç¡®ä¿é•¿æœŸç¨³å®šæ€§ã€‚åœ¨ amdgpu é©±åŠ¨ä¸­ï¼ŒPro å’Œ RX ç³»åˆ—å…±äº«åŒä¸€å¥—ä»£ç ï¼Œå·®å¼‚ä¸»è¦åœ¨å›ºä»¶å±‚ã€‚',
              'Instinct MI æ•°æ®ä¸­å¿ƒçº§ï¼šè¿™æ˜¯ AMD ç”¨æ¥ä¸ NVIDIA A100/H100 ç«äº‰çš„äº§å“çº¿ã€‚MI300X æ‹¥æœ‰ 192GB HBM3 æ˜¾å­˜ï¼Œä¸“ä¸º AI è®­ç»ƒå’Œ HPC è®¾è®¡ã€‚å…³é”®åŒºåˆ«ï¼šï¼ˆ1ï¼‰æ²¡æœ‰æ˜¾ç¤ºè¾“å‡ºâ€”â€”Instinct GPU æ˜¯çº¯è®¡ç®—å¡ï¼Œæ²¡æœ‰ HDMI/DP æ¥å£ï¼Œamdgpu é©±åŠ¨ä¸­çš„ DCï¼ˆDisplay Coreï¼‰æ¨¡å—ä¸åŠ è½½ï¼›ï¼ˆ2ï¼‰é€šè¿‡ ROCm/KFD æ¥å£æš´éœ²è®¡ç®—èƒ½åŠ›ï¼›ï¼ˆ3ï¼‰æ”¯æŒ GPU-GPU ç›´è¿ï¼ˆAMD Infinity Fabricï¼‰ï¼Œå¤šå¡å¯ä»¥åƒä¸€ä¸ªå¤§ GPU ä¸€æ ·å·¥ä½œã€‚åœ¨å†…æ ¸ä»£ç ä¸­ï¼ŒInstinct ä½¿ç”¨ç‹¬ç«‹çš„ Device ID èŒƒå›´ï¼ŒKFD æ¨¡å—ä¸ºå…¶æä¾› HSA æ¥å£ã€‚',
              'å¯¹é©±åŠ¨å¼€å‘è€…çš„æ„ä¹‰ï¼šä½ ä¿®æ”¹ amdgpu ä»£ç ä¸­çš„ä»»ä½•ä¸€è¡Œï¼Œéƒ½å¯èƒ½å½±å“è¿™ä¸‰ä¸ªäº§å“å±‚æ¬¡ã€‚ä¸€ä¸ª GEM å†…å­˜åˆ†é…çš„ Bug å¯èƒ½åœ¨ RX ä¸Šå¯¼è‡´æ¸¸æˆå´©æºƒï¼Œåœ¨ Pro ä¸Šå¯¼è‡´ CAD æ¸²æŸ“é”™è¯¯ï¼Œåœ¨ Instinct ä¸Šå¯¼è‡´ AI è®­ç»ƒæ•°æ®æŸåã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ amdgpu çš„ CI éœ€è¦åœ¨å¤šä»£ã€å¤šå±‚æ¬¡çš„ç¡¬ä»¶ä¸Šæµ‹è¯•ã€‚',
            ],
            keyPoints: [
              'Radeon RXï¼ˆæ¶ˆè´¹çº§ï¼‰ï¼šæ¸¸æˆå’Œåˆ›æ„ï¼Œä¼˜åŒ– Vulkan/OpenGL æ€§èƒ½ï¼Œä»·æ ¼ $200-$1200',
              'Radeon Proï¼ˆä¸“ä¸šçº§ï¼‰ï¼šCAD/å½±è§†ï¼Œç›¸åŒèŠ¯ç‰‡ä½†ç»è¿‡ä¸“ä¸šè®¤è¯å’Œ ECC é…ç½®',
              'Instinct MIï¼ˆæ•°æ®ä¸­å¿ƒï¼‰ï¼šAI/HPC çº¯è®¡ç®—å¡ï¼Œæ— æ˜¾ç¤ºè¾“å‡ºï¼ŒHBM æ˜¾å­˜ï¼ŒROCm æ¥å£',
              'ä¸‰ä¸ªå±‚æ¬¡å…±äº«åŒä¸€ä¸ª amdgpu å†…æ ¸é©±åŠ¨ï¼Œå·®å¼‚åœ¨å›ºä»¶å’Œç”¨æˆ·æ€é…ç½®',
              'Pro å’Œ RX é€šå¸¸ä½¿ç”¨ç›¸åŒçš„ GPU èŠ¯ç‰‡ï¼ˆNavi31 ç­‰ï¼‰ï¼Œåªæ˜¯å›ºä»¶å’Œè®¤è¯ä¸åŒ',
              'Instinct MI300X æœ‰ 192GB HBM3ï¼Œæ˜¯å½“å‰æœ€å¤§çš„ AMD GPU äº§å“',
            ],
          },
          diagram: {
            title: 'AMD GPU äº§å“çº¿ä¸‰å±‚ç»“æ„',
            content: `AMD GPU äº§å“çº¿å±‚æ¬¡ï¼ˆ2024-2025ï¼‰

æ€§èƒ½/ä»·æ ¼
    â†‘
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â”‚  Instinct MI ç³»åˆ— ï¼ˆæ•°æ®ä¸­å¿ƒï¼‰                          â”‚
    â”‚  â”‚                                                         â”‚
    â”‚  â”‚  MI300X  â”‚ 192GB HBM3 â”‚ 1.3TB/s  â”‚ çº¯è®¡ç®—ï¼ˆæ— æ˜¾ç¤ºï¼‰   â”‚
    â”‚  â”‚  MI250X  â”‚ 128GB HBM2eâ”‚ 3.2TB/s  â”‚ CDNA2 æ¶æ„         â”‚
    â”‚  â”‚  MI100   â”‚  32GB HBM2 â”‚ 1.2TB/s  â”‚ CDNA1 æ¶æ„         â”‚
    â”‚  â”‚                                                         â”‚
    â”‚  â”‚  â†’ ROCm / KFD æ¥å£                                     â”‚
    â”‚  â”‚  â†’ ç«äº‰å¯¹æ‰‹: NVIDIA H100/A100, Intel Gaudi             â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â”‚  Radeon Pro ç³»åˆ— ï¼ˆä¸“ä¸šå·¥ä½œç«™ï¼‰                         â”‚
    â”‚  â”‚                                                         â”‚
    â”‚  â”‚  W7900  â”‚ Navi31 â”‚ 48GB â”‚ ä¸“ä¸šè®¤è¯ + ECC               â”‚
    â”‚  â”‚  W7800  â”‚ Navi31 â”‚ 32GB â”‚ ä¸ RX 7900 åŒèŠ¯ç‰‡            â”‚
    â”‚  â”‚  W7600  â”‚ Navi33 â”‚ 8GB  â”‚ ä¸ä½ çš„ RX 7600 XT åŒèŠ¯ç‰‡ï¼   â”‚
    â”‚  â”‚                                                         â”‚
    â”‚  â”‚  â†’ OpenGL/Vulkan + ä¸“ä¸šåº”ç”¨è®¤è¯                        â”‚
    â”‚  â”‚  â†’ ç«äº‰å¯¹æ‰‹: NVIDIA RTX A ç³»åˆ—                         â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  â”‚  Radeon RX ç³»åˆ— ï¼ˆæ¶ˆè´¹çº§æ¸¸æˆï¼‰                          â”‚
    â”‚  â”‚                                                         â”‚
    â”‚  â”‚  RX 9070 XT  â”‚ Navi48  â”‚ RDNA4 â”‚ $549  â”‚ æœ€æ–°         â”‚
    â”‚  â”‚  RX 7900 XTX â”‚ Navi31  â”‚ RDNA3 â”‚ $999  â”‚ æ——èˆ°         â”‚
    â”‚  â”‚  RX 7800 XT  â”‚ Navi32  â”‚ RDNA3 â”‚ $499  â”‚ é«˜ç«¯         â”‚
    â”‚  â”‚  RX 7600 XT  â”‚ Navi33  â”‚ RDNA3 â”‚ $329  â”‚ â† ä½ çš„å¡    â”‚
    â”‚  â”‚  RX 6800 XT  â”‚ Navi21  â”‚ RDNA2 â”‚ (ä¸Šä»£)               â”‚
    â”‚  â”‚                                                         â”‚
    â”‚  â”‚  â†’ æ¸¸æˆ / åˆ›æ„å·¥ä½œ / è½»åº¦è®¡ç®—                          â”‚
    â”‚  â”‚  â†’ ç«äº‰å¯¹æ‰‹: NVIDIA GeForce RTX ç³»åˆ—                   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ—¶é—´

å†…æ ¸é©±åŠ¨è§†è§’ï¼š
  æ‰€æœ‰äº§å“ â†’ åŒä¸€ä¸ª amdgpu.ko â†’ é€šè¿‡ Device ID åŒºåˆ†
  RX/Pro   â†’ åŠ è½½ DC (æ˜¾ç¤º) + GFX + SDMA + VCN
  Instinct â†’ ä¸åŠ è½½ DC, åŠ è½½ KFD + GFX + SDMA`,
            caption: 'AMD GPU ä¸‰å±‚äº§å“çº¿ã€‚RX 7600 XT (Navi33) ä¸ Radeon Pro W7600 ä½¿ç”¨å®Œå…¨ç›¸åŒçš„èŠ¯ç‰‡ã€‚amdgpu é©±åŠ¨é€šè¿‡ PCI Device ID åŒºåˆ†ä¸åŒäº§å“ï¼Œä½†å…±äº«ç»å¤§éƒ¨åˆ†ä»£ç â€”â€”è¿™ä¸€è§„å¾‹é€‚ç”¨äºæ•´ä¸ª AMD äº§å“ç³»åˆ—ã€‚',
          },
          codeWalk: {
            title: 'åœ¨å†…æ ¸ä»£ç ä¸­åŒºåˆ†æ¶ˆè´¹çº§å’Œæ•°æ®ä¸­å¿ƒ GPU',
            file: 'drivers/gpu/drm/amd/amdgpu/amdgpu_device.c',
            language: 'c',
            code: `/* amdgpu é©±åŠ¨å¦‚ä½•åŒºåˆ†ä¸åŒäº§å“å±‚æ¬¡çš„ GPU */

/* 1. é€šè¿‡ PCI Device ID è¯†åˆ« GPU å‹å· */
/* amdgpu_drv.c â€” è®¾å¤‡ ID è¡¨ï¼ˆéƒ¨åˆ†ï¼‰ */
static const struct pci_device_id pciidlist[] = {
    /* æ¶ˆè´¹çº§ RX 7600 XT (Navi33) */
    {0x1002, 0x7480, PCI_ANY_ID, PCI_ANY_ID, 0, 0, CHIP_NAVI33},

    /* ä¸“ä¸šçº§ Pro W7600 (åŒä¸€ä¸ª Navi33 èŠ¯ç‰‡ï¼) */
    {0x1002, 0x7481, PCI_ANY_ID, PCI_ANY_ID, 0, 0, CHIP_NAVI33},

    /* æ•°æ®ä¸­å¿ƒ Instinct MI300X (ä¸åŒæ¶æ„: CDNA3) */
    {0x1002, 0x740C, PCI_ANY_ID, PCI_ANY_ID, 0, 0, CHIP_AQUA_VANJARAM},
};

/* 2. åˆ¤æ–­æ˜¯å¦æœ‰æ˜¾ç¤ºè¾“å‡º */
/* amdgpu_device.c â€” åˆå§‹åŒ–æ—¶æ£€æŸ¥ */
static int amdgpu_device_ip_early_init(struct amdgpu_device *adev)
{
    /* Instinct GPU æ²¡æœ‰æ˜¾ç¤ºå¼•æ“ */
    if (adev->flags & AMD_IS_APU) {
        /* APU: CPU+GPU é›†æˆï¼Œæœ‰æ˜¾ç¤º */
    }

    /* æ ¹æ® IP discovery æ£€æŸ¥æ˜¯å¦æœ‰ DCN (Display) */
    if (!adev->ip_versions[DCE_HWIP][0]) {
        /* æ²¡æœ‰ DCN IP â†’ çº¯è®¡ç®—å¡ (Instinct) */
        /* ä¸åŠ è½½ DC æ¨¡å—ï¼Œä¸åˆ›å»º /dev/dri/card0 çš„ KMS æ¥å£ */
        adev->mode_info.num_crtc = 0;
    }
}

/* 3. KFD å¯¹ä¸åŒäº§å“çš„ä¼˜å…ˆçº§ */
/* amdkfd/kfd_device.c */
/* Instinct GPU çš„ KFD è·å¾—æ›´å¤šè®¡ç®—é˜Ÿåˆ—èµ„æº
 * æ¶ˆè´¹çº§ GPU çš„ KFD é˜Ÿåˆ—æ•°é‡å—é™ */`,
            annotations: [
              'RX 7600 XT (0x7480) å’Œ Pro W7600 (0x7481) æ˜¯ä¸åŒçš„ Device ID ä½† CHIP ç±»å‹ç›¸åŒ (CHIP_NAVI33)',
              'CHIP_AQUA_VANJARAM æ˜¯ MI300X çš„å†…éƒ¨ä»£å·ï¼Œä½¿ç”¨ CDNA3 æ¶æ„è€Œé RDNA3',
              'AMD_IS_APU æ ‡å¿—åŒºåˆ† APUï¼ˆé›†æˆ GPUï¼‰å’Œç‹¬ç«‹ GPU',
              'IP discovery æœºåˆ¶è‡ªåŠ¨æ£€æµ‹ GPU æœ‰å“ªäº›åŠŸèƒ½æ¨¡å—ï¼ˆIP Blockï¼‰ï¼ŒInstinct æ²¡æœ‰ DCE_HWIP',
              'åŒä¸€ä¸ª amdgpu.ko é€šè¿‡æ¡ä»¶é€»è¾‘å¤„ç†æ‰€æœ‰äº§å“å±‚æ¬¡çš„å·®å¼‚',
              'KFD ä¸º Instinct GPU åˆ†é…æ›´å¤šè®¡ç®—èµ„æºâ€”â€”è¿™æ˜¯çº¯è®¡ç®—å¡çš„ä¼˜åŒ–',
            ],
            explanation: 'è¿™æ®µä»£ç å±•ç¤ºäº† amdgpu é©±åŠ¨å¦‚ä½•ç”¨ä¸€å¥—ä»£ç æ”¯æŒä¸‰ä¸ªå®Œå…¨ä¸åŒçš„äº§å“å±‚æ¬¡ã€‚å…³é”®æ´å¯Ÿï¼šç¡¬ä»¶å·®å¼‚ä¸æ˜¯é  if/else ç¡¬ç¼–ç çš„ï¼Œè€Œæ˜¯é€šè¿‡ IP discovery æœºåˆ¶åŠ¨æ€æ£€æµ‹â€”â€”é©±åŠ¨å¯åŠ¨æ—¶è¯»å– GPU çš„ IP æè¿°è¡¨ï¼Œæ ¹æ®æœ‰å“ªäº› IP Block æ¥å†³å®šåŠ è½½å“ªäº›æ¨¡å—ã€‚è¿™ç§è®¾è®¡è®©ä¸€ä¸ªé©±åŠ¨æ”¯æŒæ•°åç§ä¸åŒçš„ GPU æˆä¸ºå¯èƒ½ã€‚',
          },
          miniLab: {
            title: 'è¯†åˆ«ä½ çš„ GPU æ‰€å±çš„äº§å“å±‚æ¬¡',
            objective: 'é€šè¿‡ç³»ç»Ÿå·¥å…·ç¡®è®¤ä½ çš„ GPU çš„äº§å“å±‚æ¬¡ã€èŠ¯ç‰‡ä»£å·å’Œæ”¯æŒçš„åŠŸèƒ½æ¨¡å—ã€‚',
            steps: [
              'æŸ¥çœ‹ GPU å‹å·å’Œ Device IDï¼šlspci -nn | grep -i "vga\\|3d\\|display"',
              'ç¡®è®¤æ˜¯æ¶ˆè´¹çº§è¿˜æ˜¯ä¸“ä¸šçº§ï¼šå¦‚æœè¾“å‡ºåŒ…å« "Radeon RX" å°±æ˜¯æ¶ˆè´¹çº§ï¼Œ"Radeon Pro" æ˜¯ä¸“ä¸šçº§',
              'æŸ¥çœ‹ GPU æ”¯æŒçš„ IP Blockï¼šcat /sys/class/drm/card0/device/ip_discovery/die/0/*/ip_discoveryï¼ˆå¦‚æœå­˜åœ¨ï¼‰',
              'éªŒè¯æ˜¯å¦æœ‰æ˜¾ç¤ºè¾“å‡ºï¼šls /sys/class/drm/card0-*ï¼ˆåº”è¯¥åˆ—å‡º HDMI-A-1ã€DP-1 ç­‰è¿æ¥å™¨ï¼‰',
              'æŸ¥çœ‹ KFD æ˜¯å¦å¯ç”¨ï¼šls /dev/kfdï¼ˆå¦‚æœå­˜åœ¨ï¼Œè¯´æ˜ ROCm è®¡ç®—æ¥å£å¯ç”¨ï¼‰',
              'å¯¹æ¯”ï¼šåœ¨ amdgpu æºç ä¸­æœç´¢ä½ çš„ Device IDï¼šgrep -n "0x7480" drivers/gpu/drm/amd/amdgpu/amdgpu_drv.c',
            ],
            expectedOutput: `$ lspci -nn | grep -i "vga"
03:00.0 VGA compatible controller [0300]: ... Navi33 [Radeon RX 7600/7600 XT] [1002:7480]
â†’ æ¶ˆè´¹çº§ RX ç³»åˆ—ï¼ŒDevice ID 0x7480

$ ls /sys/class/drm/card0-*
/sys/class/drm/card0-DP-1
/sys/class/drm/card0-HDMI-A-1
â†’ æœ‰æ˜¾ç¤ºè¾“å‡ºè¿æ¥å™¨ï¼ˆä¸æ˜¯ Instinct çº¯è®¡ç®—å¡ï¼‰

$ ls /dev/kfd
/dev/kfd
â†’ KFD æ¥å£å¯ç”¨ï¼Œå¯ä»¥è¿è¡Œ ROCm ç¨‹åº`,
            hint: 'å¦‚æœ /dev/kfd ä¸å­˜åœ¨ï¼Œå¯èƒ½æ˜¯ KFD æ¨¡å—æ²¡æœ‰åŠ è½½ã€‚å°è¯• sudo modprobe amdkfd æˆ–æ£€æŸ¥å†…æ ¸é…ç½®ä¸­ HSA_AMD æ˜¯å¦å¯ç”¨ã€‚',
          },
          debugExercise: {
            title: 'åˆ¤æ–­ GPU ç±»å‹å¯¹é©±åŠ¨è¡Œä¸ºçš„å½±å“',
            language: 'c',
            description: 'ä»¥ä¸‹ä»£ç å°è¯•åœ¨ä¸€ä¸ª Instinct MI300X GPU ä¸Šè®¾ç½®æ˜¾ç¤ºæ¨¡å¼ï¼Œä½†ä¼šå¤±è´¥ã€‚æ‰¾å‡ºåŸå› ã€‚',
            question: 'ä¸ºä»€ä¹ˆè¿™æ®µä»£ç åœ¨ Instinct GPU ä¸Šä¼šè¿”å›é”™è¯¯ï¼Ÿ',
            buggyCode: `/* å°è¯•åœ¨ GPU ä¸Šè®¾ç½® 1920x1080 æ˜¾ç¤ºæ¨¡å¼ */
int setup_display(struct amdgpu_device *adev)
{
    struct drm_display_mode mode;

    mode.hdisplay = 1920;
    mode.vdisplay = 1080;
    mode.clock = 148500;  /* 148.5 MHz pixel clock */

    /* è°ƒç”¨ DC æ¨¡å—è®¾ç½®æ˜¾ç¤ºæ¨¡å¼ */
    return dc_commit_state(adev->dm.dc, &mode);
    /* åœ¨ Instinct MI300X ä¸Šè¿”å› -ENODEV */
}`,
            hint: 'Instinct MI300X æ˜¯ä¸€å¼ çº¯è®¡ç®—å¡ã€‚æƒ³æƒ³å®ƒæœ‰å“ªäº› IP Blockï¼Œæ²¡æœ‰å“ªäº›ã€‚',
            answer: 'Instinct MI300X æ˜¯çº¯è®¡ç®— GPUï¼Œæ²¡æœ‰æ˜¾ç¤ºå¼•æ“ï¼ˆDCN IPï¼‰ã€‚åœ¨é©±åŠ¨åˆå§‹åŒ–æ—¶ï¼Œamdgpu é€šè¿‡ IP discovery æ£€æµ‹åˆ°æ²¡æœ‰ DCE_HWIPï¼Œå› æ­¤ä¸ä¼šåŠ è½½ DCï¼ˆDisplay Coreï¼‰æ¨¡å—ã€‚adev->dm.dc ä¸º NULLï¼Œè°ƒç”¨ dc_commit_state ä¼šè¿”å› -ENODEVï¼ˆè®¾å¤‡ä¸å­˜åœ¨ï¼‰ã€‚Instinct å¡æ²¡æœ‰ HDMI/DP æ¥å£ï¼Œç‰©ç†ä¸Šå°±ä¸æ”¯æŒæ˜¾ç¤ºè¾“å‡ºã€‚è¿™ä¸æ˜¯ Bugï¼Œè€Œæ˜¯ç¡¬ä»¶è®¾è®¡å¦‚æ­¤â€”â€”Instinct æŠŠæ‰€æœ‰æ™¶ä½“ç®¡é¢ç§¯éƒ½ç”¨äºè®¡ç®—å•å…ƒå’Œ HBM æ§åˆ¶å™¨ï¼Œä¸æµªè´¹åœ¨æ˜¾ç¤ºåŠŸèƒ½ä¸Šã€‚æ­£ç¡®åšæ³•ï¼šåœ¨è°ƒç”¨ DC å‡½æ•°å‰æ£€æŸ¥ adev->mode_info.num_crtc > 0ã€‚',
          },
          interviewQ: {
            question: 'AMD GPU çš„ä¸‰ä¸ªäº§å“å±‚æ¬¡ï¼ˆRadeon RXã€Radeon Proã€Instinct MIï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿamdgpu é©±åŠ¨å¦‚ä½•å¤„ç†å®ƒä»¬çš„å·®å¼‚ï¼Ÿ',
            difficulty: 'easy',
            hint: 'ä»ç¡¬ä»¶åŠŸèƒ½ï¼ˆæ˜¾ç¤º/è®¡ç®—ï¼‰ã€é©±åŠ¨æ¨¡å—åŠ è½½ï¼ˆDC/KFDï¼‰ã€ç›®æ ‡ç”¨æˆ·ç¾¤ä¸‰ä¸ªç»´åº¦å¯¹æ¯”ã€‚',
            answer: 'ä¸‰å±‚åŒºåˆ«ï¼šï¼ˆ1ï¼‰Radeon RXï¼ˆæ¶ˆè´¹çº§ï¼‰ï¼šé¢å‘æ¸¸æˆ/åˆ›æ„ç”¨æˆ·ï¼Œæœ‰å®Œæ•´çš„å›¾å½¢å’Œæ˜¾ç¤ºåŠŸèƒ½ï¼Œé©±åŠ¨åŠ è½½ GFX + DC + VCN + SDMA + KFDï¼ˆå¦‚æœå¯ç”¨ ROCmï¼‰ï¼›ä¼˜åŒ–ç›®æ ‡æ˜¯æ¸²æŸ“æ€§èƒ½å’Œä½å»¶è¿Ÿã€‚ï¼ˆ2ï¼‰Radeon Proï¼ˆä¸“ä¸šçº§ï¼‰ï¼šé¢å‘ CAD/å½±è§†ä¸“ä¸šç”¨æˆ·ï¼Œä¸ RX ä½¿ç”¨ç›¸åŒèŠ¯ç‰‡ä½†å›ºä»¶ä¸åŒâ€”â€”ç»è¿‡ä¸“ä¸šåº”ç”¨è®¤è¯ï¼Œæ”¯æŒ ECC æ˜¾å­˜ï¼Œé¢‘ç‡æ›´ä¿å®ˆï¼›é©±åŠ¨ä»£ç å®Œå…¨å…±äº«ï¼Œå·®å¼‚åœ¨å›ºä»¶å±‚ã€‚ï¼ˆ3ï¼‰Instinct MIï¼ˆæ•°æ®ä¸­å¿ƒï¼‰ï¼šé¢å‘ AI/HPCï¼Œçº¯è®¡ç®—å¡æ— æ˜¾ç¤ºè¾“å‡ºï¼Œä½¿ç”¨ CDNA æ¶æ„ï¼ˆä¸æ˜¯ RDNAï¼‰ï¼Œé©±åŠ¨ä¸åŠ è½½ DC æ¨¡å—ï¼Œé€šè¿‡ KFD æš´éœ² HSA è®¡ç®—æ¥å£ï¼›æ‹¥æœ‰ HBM å¤§æ˜¾å­˜å’Œ GPU-GPU ç›´è¿ã€‚é©±åŠ¨å¤„ç†å·®å¼‚çš„æ–¹å¼ï¼šamdgpu ä½¿ç”¨ IP discovery æœºåˆ¶â€”â€”é©±åŠ¨å¯åŠ¨æ—¶è¯»å– GPU çš„ IP æè¿°è¡¨ï¼Œæ ¹æ®æ£€æµ‹åˆ°çš„ IP Blockï¼ˆDCN/GFX/SDMA/VCN/KFDï¼‰åŠ¨æ€å†³å®šåŠ è½½å“ªäº›æ¨¡å—ã€‚è¿™ç§è®¾è®¡è®©ä¸€ä¸ª .ko æ–‡ä»¶æ”¯æŒæ‰€æœ‰ AMD GPU æˆä¸ºå¯èƒ½ã€‚',
            amdContext: 'ç†è§£äº§å“çº¿å±‚æ¬¡æ˜¯ AMD é¢è¯•çš„åŸºç¡€é—®é¢˜ã€‚é¢è¯•å®˜æœŸæœ›ä½ çŸ¥é“ RXã€Proã€Instinct çš„åŒºåˆ«ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•å…±äº«é©±åŠ¨ä»£ç ã€‚',
          },
        },

        // â”€â”€ Lesson 0.5.1.2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        {
          id: '05-1-2',
          number: '0.5.1.2',
          title: 'GPU å‘½åè§„åˆ™å®Œå…¨è§£æï¼šä»å‹å·åˆ°å†…æ ¸ä»£å·',
          titleEn: 'GPU Naming Decoded: From Model to Kernel Codename',
          duration: 20,
          difficulty: 'beginner',
          tags: ['naming', 'Navi', 'RDNA', 'gfx1102', 'device-id'],
          concept: {
            summary: 'æ¯ä¸ª AMD GPU æœ‰å››å±‚å‘½åï¼šå¸‚åœºåã€èŠ¯ç‰‡ä»£å·ã€IP ç‰ˆæœ¬ã€PCI Device IDã€‚æŒæ¡è¿™å››å±‚æ˜ å°„å…³ç³»ï¼Œä½ å°±èƒ½ä»ä»»ä½•ä¸€å±‚æ¨æ–­å‡ºå…¶ä»–ä¸‰å±‚ï¼Œåœ¨é©±åŠ¨ä»£ç ä¸­å¿«é€Ÿå®šä½ã€‚æœ¬èŠ‚ä»¥ RX 7600 XTï¼ˆNavi33 / gfx1102 / 0x7480ï¼‰ä¸ºè´¯ç©¿ç¤ºä¾‹ï¼Œæ–¹æ³•é€‚ç”¨äºæ‰€æœ‰ AMD GPUã€‚',
            explanation: [
              'å½“ä½ åœ¨ amdgpu æºç ä¸­çœ‹åˆ° "gfx1102" æ—¶ï¼Œä½ éœ€è¦ç«‹åˆ»çŸ¥é“è¿™å¯¹åº”çš„æ˜¯ RDNA3 æ¶æ„çš„ Navi33 èŠ¯ç‰‡ï¼Œå¸‚åœºä¸Šä»¥ RX 7600 ç³»åˆ—é”€å”®ã€‚è¿™ç§å¿«é€Ÿæ˜ å°„èƒ½åŠ›æ˜¯é«˜æ•ˆé˜…è¯»é©±åŠ¨ä»£ç çš„å…³é”®ã€‚è®©æˆ‘ä»¬æ‹†è§£ AMD GPU çš„å®Œæ•´å‘½åä½“ç³»ã€‚',
              'ç¬¬ä¸€å±‚ï¼šå¸‚åœºåï¼ˆRX 7600 XTï¼‰ã€‚è¿™æ˜¯æ¶ˆè´¹è€…çœ‹åˆ°çš„åç§°ã€‚RX = Radeon eXperienceï¼ˆæ¶ˆè´¹çº§æ ‡è¯†ï¼‰ï¼›ç¬¬ä¸€ä¸ªæ•°å­— 7 = æ¶æ„ä»£æ•°ï¼ˆ7=RDNA3ï¼Œ6=RDNA2ï¼Œ5=RDNA1ï¼‰ï¼›ç¬¬äºŒä¸ªæ•°å­— 6 = æ€§èƒ½ç­‰çº§ï¼ˆ9=æ——èˆ°ï¼Œ8=é«˜ç«¯ï¼Œ7=ä¸­é«˜ç«¯ï¼Œ6=ä¸­ç«¯ï¼Œ5=å…¥é—¨ï¼‰ï¼›åä¸¤ä½ 00 = å…·ä½“ SKUï¼›åç¼€ XT = å¢å¼ºç‰ˆï¼ˆæ›´é«˜é¢‘ç‡æˆ–æ›´å¤šè®¡ç®—å•å…ƒï¼‰ï¼ŒXTX = æ——èˆ°å¢å¼ºç‰ˆã€‚æ‰€ä»¥ RX 7600 XT = RDNA3 æ¶æ„ã€ä¸­ç«¯æ€§èƒ½ã€å¢å¼ºç‰ˆã€‚',
              'ç¬¬äºŒå±‚ï¼šèŠ¯ç‰‡ä»£å·ï¼ˆNavi33ï¼‰ã€‚è¿™æ˜¯å†…éƒ¨å·¥ç¨‹ä»£å·ã€‚Navi = RDNA æ¶æ„ç³»åˆ—çš„ä»£å·ï¼ˆå‰ä»£æ˜¯ Vega/Polarisï¼‰ã€‚æ•°å­—çš„åä½è¡¨ç¤ºä»£æ•°ï¼ˆ3x = RDNA3ï¼Œ2x = RDNA2ï¼Œ1x = RDNA1ï¼‰ï¼Œä¸ªä½ä»å¤§åˆ°å°è¡¨ç¤ºèŠ¯ç‰‡é¢ç§¯ï¼šNavi31 æ˜¯æ——èˆ°å¤§èŠ¯ç‰‡ï¼ˆRX 7900 XTXï¼‰ï¼ŒNavi32 æ˜¯é«˜ç«¯ä¸­èŠ¯ç‰‡ï¼ˆRX 7800 XTï¼‰ï¼ŒNavi33 æ˜¯ä¸­ç«¯å°èŠ¯ç‰‡ï¼ˆRX 7600 XTï¼‰ã€‚åœ¨å†…æ ¸ä»£ç ä¸­ï¼ŒCHIP_NAVI33 æ˜¯æšä¸¾å€¼ï¼Œç”¨äºé€‰æ‹© IP Block å®ç°ã€‚',
              'ç¬¬ä¸‰å±‚ï¼šIP ç‰ˆæœ¬ï¼ˆgfx1102ï¼‰ã€‚è¿™æ˜¯æœ€æ¥è¿‘ç¡¬ä»¶çš„å‘½åã€‚gfx = Graphics IP å‰ç¼€ï¼›11 = ä¸»ç‰ˆæœ¬å·ï¼ˆå¯¹åº” RDNA3ï¼‰ï¼›0 = æ¬¡ç‰ˆæœ¬å·ï¼›2 = ä¿®è®¢å·ã€‚gfx1100 = Navi31ï¼ˆæ——èˆ°ï¼‰ï¼Œgfx1102 = Navi33ï¼ˆä¸­ç«¯ï¼‰ã€‚ä¸åŒä¿®è®¢å·æ„å‘³ç€åŒä»£æ¶æ„ä¸­çš„å¾®å°å·®å¼‚ï¼ˆå¦‚æ—¶é’ŸåŸŸã€CU æ•°é‡ï¼‰ã€‚åœ¨ LLVM ä¸­ç¼–è¯‘ GPU ç¨‹åºæ—¶ï¼Œ-mcpu=gfx1102 æŒ‡å®šç›®æ ‡ GPUã€‚åœ¨é©±åŠ¨ä»£ç ä¸­ï¼Œgfx_v11_0.c æ˜¯ gfx11xx ç³»åˆ—çš„å®ç°æ–‡ä»¶ã€‚',
              'ç¬¬å››å±‚ï¼šPCI Device IDï¼ˆ0x7480ï¼‰ã€‚è¿™æ˜¯ PCI æ€»çº¿ä¸Šçš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚å†…æ ¸é€šè¿‡åŒ¹é… Vendor IDï¼ˆ0x1002ï¼‰+ Device IDï¼ˆ0x7480ï¼‰æ‰¾åˆ° amdgpu é©±åŠ¨ã€‚åŒä¸€ä¸ªèŠ¯ç‰‡å¯èƒ½æœ‰å¤šä¸ª Device IDï¼ˆä¸åŒ SKUï¼‰ï¼Œä½†æ˜ å°„åˆ°åŒä¸€ä¸ª CHIP ç±»å‹ã€‚åœ¨ amdgpu_drv.c çš„ pciidlist ä¸­ï¼Œ0x7480 å’Œ 0x7483 éƒ½æ˜ å°„åˆ° CHIP_NAVI33ã€‚',
            ],
            keyPoints: [
              'å¸‚åœºå RX 7600 XT â†’ ç¬¬ä¸€ä½ 7=RDNA3ï¼Œç¬¬äºŒä½ 6=ä¸­ç«¯ï¼ŒXT=å¢å¼ºç‰ˆ',
              'èŠ¯ç‰‡ä»£å· Navi33 â†’ 3x=RDNA3 ä»£ï¼Œ3=ä¸­ç«¯èŠ¯ç‰‡ï¼ˆæœ€å°çš„ RDNA3 dieï¼‰',
              'IP ç‰ˆæœ¬ gfx1102 â†’ 11=RDNA3ï¼Œ02=Navi33 ä¿®è®¢ï¼ˆ00=Navi31ï¼Œ02=Navi33ï¼‰',
              'PCI Device ID 0x7480 â†’ å†…æ ¸åŒ¹é…é©±åŠ¨çš„å”¯ä¸€æ ‡è¯†ç¬¦',
              'å®Œæ•´æ˜ å°„é“¾ï¼šRX 7600 XT â†” Navi33 â†” gfx1102 â†” 0x7480 â†” CHIP_NAVI33',
              'åœ¨ LLVM ä¸­ -mcpu=gfx1102ï¼Œåœ¨é©±åŠ¨ä¸­ gfx_v11_0.cï¼Œåœ¨ PCI è¡¨ä¸­ CHIP_NAVI33',
            ],
          },
          diagram: {
            title: 'AMD GPU å››å±‚å‘½åæ˜ å°„è¡¨',
            content: `AMD GPU å‘½åå››å±‚æ˜ å°„ï¼ˆRDNA ç³»åˆ—ï¼‰

å¸‚åœºå             èŠ¯ç‰‡ä»£å·      IP ç‰ˆæœ¬      Device ID    å†…æ ¸æšä¸¾
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

RDNA4 (2025):
RX 9070 XT         Navi48       gfx1201     0x7550      CHIP_NAVI48

RDNA3 (2022):
RX 7900 XTX        Navi31       gfx1100     0x744C      CHIP_NAVI31
RX 7900 XT         Navi31       gfx1100     0x744C      CHIP_NAVI31
RX 7800 XT         Navi32       gfx1101     0x7470      CHIP_NAVI32
RX 7700 XT         Navi32       gfx1101     0x7470      CHIP_NAVI32
RX 7600 XT â† ä½    Navi33       gfx1102     0x7480      CHIP_NAVI33
RX 7600            Navi33       gfx1102     0x7480      CHIP_NAVI33

RDNA2 (2020):
RX 6900 XT         Navi21       gfx1030     0x73BF      CHIP_NAVI21
RX 6800 XT         Navi21       gfx1030     0x73BF      CHIP_NAVI21
RX 6700 XT         Navi22       gfx1031     0x73DF      CHIP_NAVI22
RX 6600 XT         Navi23       gfx1032     0x73FF      CHIP_NAVI23

RDNA1 (2019):
RX 5700 XT         Navi10       gfx1010     0x731F      CHIP_NAVI10
RX 5600 XT         Navi10       gfx1010     0x7340      CHIP_NAVI10

ä»£ç ä¸­çš„å¯¹åº”å…³ç³»ï¼š
  gfx1102 â†’ gfx_v11_0.cï¼ˆå…±äº« RDNA3 GFX å®ç°ï¼‰
  gfx1030 â†’ gfx_v10_3.cï¼ˆRDNA2 GFX å®ç°ï¼‰
  gfx1010 â†’ gfx_v10_0.cï¼ˆRDNA1 GFX å®ç°ï¼‰`,
            caption: 'AMD GPU å››å±‚å‘½åæ˜ å°„ç¤ºä¾‹ã€‚ç†è§£è¿™å¥—æ˜ å°„è§„åˆ™åï¼Œé‡åˆ°ä»»ä½• AMD GPU å‹å·éƒ½èƒ½ç«‹å³æ¨æ–­å‡ºå…¶ä»–ä¸‰å±‚ï¼ˆå¦‚ RX 7600 XT â†” Navi33 â†” gfx1102 â†” 0x7480ï¼‰ã€‚',
          },
          codeWalk: {
            title: 'ä» Device ID åˆ° IP ç‰ˆæœ¬çš„å®Œæ•´æ˜ å°„é“¾',
            file: 'drivers/gpu/drm/amd/amdgpu/amdgpu_discovery.c',
            language: 'c',
            code: `/* é©±åŠ¨å¦‚ä½•ä» PCI Device ID æ¨å¯¼å‡º IP ç‰ˆæœ¬ */

/* æ­¥éª¤ 1: PCI åŒ¹é… â†’ CHIP æšä¸¾ (amdgpu_drv.c) */
/* {0x1002, 0x7480, ..., CHIP_NAVI33} */

/* æ­¥éª¤ 2: CHIP æšä¸¾ â†’ IP discovery (amdgpu_discovery.c) */
/* GPU å†…éƒ¨æœ‰ä¸€ä¸ª IP discovery è¡¨ï¼Œå›ºåŒ–åœ¨ç¡¬ä»¶ä¸­
 * é©±åŠ¨åœ¨åˆå§‹åŒ–æ—¶è¯»å–è¿™ä¸ªè¡¨ï¼Œè·å–æ‰€æœ‰ IP Block çš„ç‰ˆæœ¬ */
static int amdgpu_discovery_set_ip_blocks(struct amdgpu_device *adev)
{
    /* è¯»å– GPU å†…éƒ¨çš„ IP discovery æ•°æ® */
    /* è¿”å›ç±»ä¼¼ï¼š
     * GFX IP version: 11.0.2  â†’ gfx1102 (ä½ çš„ RX 7600 XT)
     * SDMA IP version: 6.0.2  â†’ sdma_v6_0
     * DCN IP version: 3.2.1   â†’ dcn32
     * VCN IP version: 4.0.2   â†’ vcn_v4_0
     */

    switch (adev->ip_versions[GC_HWIP][0]) {
    case IP_VERSION(11, 0, 0):  /* gfx1100 = Navi31 */
    case IP_VERSION(11, 0, 2):  /* gfx1102 = Navi33 (ä½ çš„!) */
        amdgpu_device_ip_block_add(adev, &gfx_v11_0_ip_block);
        amdgpu_device_ip_block_add(adev, &sdma_v6_0_ip_block);
        break;
    case IP_VERSION(10, 3, 0):  /* gfx1030 = Navi21 (RDNA2) */
        amdgpu_device_ip_block_add(adev, &gfx_v10_0_ip_block);
        break;
    }
}

/* æ­¥éª¤ 3: ä½¿ç”¨ IP ç‰ˆæœ¬ç¼–è¯‘ç€è‰²å™¨ (LLVM) */
/* hipcc --offload-arch=gfx1102 my_kernel.hip
 * LLVM æ ¹æ® gfx1102 é€‰æ‹©æ­£ç¡®çš„æŒ‡ä»¤é›†å’Œå¯„å­˜å™¨é…ç½® */`,
            annotations: [
              'IP discovery æ˜¯ AMD GPU çš„ç¡¬ä»¶ç‰¹æ€§â€”â€”GPU å†…éƒ¨å­˜å‚¨äº†ä¸€å¼ æè¿°è‡ªèº«åŠŸèƒ½çš„è¡¨',
              'IP_VERSION(11, 0, 2) å¯¹åº” gfx1102ï¼Œ11=ä¸»ç‰ˆæœ¬ï¼Œ0=æ¬¡ç‰ˆæœ¬ï¼Œ2=ä¿®è®¢å·',
              'Navi31 (gfx1100) å’Œ Navi33 (gfx1102) å…±äº« gfx_v11_0_ip_blockï¼Œå› ä¸ºå®ƒä»¬æ˜¯åŒä»£æ¶æ„',
              'SDMAã€DCNã€VCN ç­‰ IP Block ä¹Ÿæœ‰å„è‡ªçš„ç‰ˆæœ¬å·ï¼Œç‹¬ç«‹äº GFX IP ç‰ˆæœ¬',
              'è¿™ç§åŠ¨æ€å‘ç°æœºåˆ¶è®©é©±åŠ¨ä¸éœ€è¦ä¸ºæ¯ä¸ª GPU ç¡¬ç¼–ç åŠŸèƒ½åˆ—è¡¨',
            ],
            explanation: 'IP discovery æ˜¯ç†è§£ amdgpu é©±åŠ¨æ¶æ„çš„å…³é”®ã€‚é©±åŠ¨ä¸æ˜¯é€šè¿‡ if (chip == NAVI33) æ¥å†³å®šè¡Œä¸ºçš„ï¼Œè€Œæ˜¯è¯»å– GPU è‡ªèº«çš„ IP æè¿°è¡¨ã€‚è¿™æ ·å³ä½¿ AMD å‘å¸ƒæ–° GPUï¼Œåªè¦ IP ç‰ˆæœ¬åœ¨å·²æ”¯æŒçš„èŒƒå›´å†…ï¼ˆå¦‚ gfx11xxï¼‰ï¼Œç°æœ‰é©±åŠ¨ä»£ç å°±èƒ½ç›´æ¥æ”¯æŒâ€”â€”è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™æ–° GPU åœ¨æ—§å†…æ ¸ä¸Šä¹Ÿèƒ½åŸºæœ¬å·¥ä½œã€‚',
          },
          miniLab: {
            title: 'å»ºç«‹ä½ çš„ GPU å‘½åæ˜ å°„å¡',
            objective: 'æŸ¥æ‰¾ä½ æ‰‹å¤´ AMD GPU çš„å››å±‚å‘½åï¼ˆä»¥ RX 7600 XT ä¸ºå‚è€ƒç¤ºä¾‹ï¼‰ï¼Œå¹¶åœ¨å†…æ ¸æºç ä¸­éªŒè¯æ¯ä¸€å±‚çš„å¯¹åº”å…³ç³»ã€‚',
            steps: [
              'è®°å½•å¸‚åœºåï¼šRX 7600 XT',
              'æŸ¥æ‰¾ Device IDï¼šlspci -nn | grep AMDï¼ˆè®°å½• [1002:xxxx] ä¸­çš„ xxxxï¼‰',
              'åœ¨å†…æ ¸æºç ä¸­æ‰¾åˆ°æ˜ å°„ï¼šgrep -n "0x7480" drivers/gpu/drm/amd/amdgpu/amdgpu_drv.c',
              'ç¡®è®¤ CHIP ç±»å‹ï¼šæ‰¾åˆ°çš„è¡Œåº”è¯¥åŒ…å« CHIP_NAVI33',
              'æŸ¥æ‰¾ IP ç‰ˆæœ¬ï¼šdmesg | grep -i "gfx.*version\\|ip version"ï¼ˆåº”è¯¥æ˜¾ç¤º 11.0.2 = gfx1102ï¼‰',
              'éªŒè¯ LLVM ç›®æ ‡åï¼šllc --version 2>&1 | grep gfx1102ï¼ˆå¦‚æœå®‰è£…äº† LLVMï¼‰',
              'åœ¨å­¦ä¹ æ—¥å¿—ä¸­è®°å½•å®Œæ•´æ˜ å°„ï¼šRX 7600 XT â†” Navi33 â†” gfx1102 â†” 0x7480 â†” CHIP_NAVI33',
            ],
            expectedOutput: `ä½ çš„ GPU å‘½åæ˜ å°„å¡ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¸‚åœºå      â”‚ RX 7600 XT                   â”‚
â”‚ èŠ¯ç‰‡ä»£å·    â”‚ Navi33                       â”‚
â”‚ IP ç‰ˆæœ¬     â”‚ gfx1102 (GFX 11.0.2)        â”‚
â”‚ PCI ID      â”‚ 1002:7480                    â”‚
â”‚ å†…æ ¸æšä¸¾    â”‚ CHIP_NAVI33                  â”‚
â”‚ GFX å®ç°    â”‚ gfx_v11_0.c                  â”‚
â”‚ SDMA å®ç°   â”‚ sdma_v6_0.c                  â”‚
â”‚ æ˜¾ç¤ºå®ç°    â”‚ dcn32                        â”‚
â”‚ æ¶æ„        â”‚ RDNA3                        â”‚
â”‚ åˆ¶ç¨‹        â”‚ TSMC 6nm                     â”‚
â”‚ CU æ•°é‡     â”‚ 32 CU                        â”‚
â”‚ VRAM        â”‚ 8GB GDDR6                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
            hint: 'å¦‚æœ dmesg ä¸­æ²¡æœ‰æ˜¾ç¤º IP versionï¼Œå°è¯• dmesg | grep -i "gfx\\|gc.*version" æˆ– cat /sys/class/drm/card0/device/gpu_metricsã€‚',
          },
          debugExercise: {
            title: 'è¯†åˆ«é”™è¯¯çš„ LLVM ç›®æ ‡å',
            language: 'bash',
            description: 'ä½ åœ¨ç¼–è¯‘ä¸€ä¸ª HIP ç¨‹åºæ—¶æŒ‡å®šäº†é”™è¯¯çš„ GPU ç›®æ ‡ã€‚åˆ†æé”™è¯¯å¹¶æ‰¾å‡ºæ­£ç¡®çš„ç›®æ ‡åã€‚',
            question: 'ä¸ºä»€ä¹ˆè¿™ä¸ªç¼–è¯‘å‘½ä»¤ä¼šåœ¨ RX 7600 XTï¼ˆgfx1102ï¼‰ä¸Šäº§ç”Ÿé”™è¯¯çš„ä»£ç ï¼Ÿï¼ˆåŒæ ·é€‚ç”¨äºå…¶ä»– gfx ç›®æ ‡ä¸åŒ¹é…çš„æƒ…å†µï¼‰',
            buggyCode: `# ç¼–è¯‘ HIP ç¨‹åºï¼ŒæŒ‡å®š GPU ç›®æ ‡
hipcc --offload-arch=gfx1100 my_kernel.hip -o my_kernel

# è¿è¡Œæ—¶å‡ºé”™ï¼š
# HSA Error: Incompatible device architecture
# Expected: gfx1102, Got: gfx1100`,
            hint: 'gfx1100 å’Œ gfx1102 è™½ç„¶éƒ½æ˜¯ RDNA3ï¼ˆgfx11xxï¼‰ï¼Œä½†å®ƒä»¬æ˜¯ä¸åŒçš„èŠ¯ç‰‡ã€‚æƒ³æƒ³ Navi31 å’Œ Navi33 çš„åŒºåˆ«ã€‚',
            answer: 'é”™è¯¯ï¼šæŒ‡å®šäº† gfx1100ï¼ˆNavi31 = RX 7900 XTXï¼‰è€Œä¸æ˜¯ gfx1102ï¼ˆNavi33 = RX 7600 XTï¼‰ã€‚è™½ç„¶ gfx1100 å’Œ gfx1102 éƒ½å±äº RDNA3 ç³»åˆ—ï¼Œä½† LLVM ä¸ºå®ƒä»¬ç”Ÿæˆçš„æŒ‡ä»¤æœ‰å¾®å°å·®å¼‚ï¼ˆå¦‚å¯ç”¨çš„ VGPR æ•°é‡ã€CU é…ç½®ã€ç¼“å­˜å¤§å°ï¼‰ã€‚HSA Runtime åœ¨åŠ è½½ GPU ç¨‹åºæ—¶ä¼šæ£€æŸ¥ ELF header ä¸­çš„ç›®æ ‡æ¶æ„æ˜¯å¦åŒ¹é…å½“å‰ GPUï¼Œä¸åŒ¹é…åˆ™æ‹’ç»åŠ è½½ã€‚æ­£ç¡®å‘½ä»¤ï¼šhipcc --offload-arch=gfx1102 my_kernel.hip -o my_kernelã€‚å¯ä»¥ç”¨ rocminfo | grep gfx æŸ¥çœ‹ä½ çš„ GPU çš„ç¡®åˆ‡ target nameã€‚å¦‚æœä½ æƒ³åŒæ—¶æ”¯æŒå¤šä¸ª GPUï¼šhipcc --offload-arch=gfx1100 --offload-arch=gfx1102 ï¼ˆä¼šç”Ÿæˆ fat binaryï¼‰ã€‚',
          },
          interviewQ: {
            question: 'è§£é‡Š AMD GPU çš„å‘½åä½“ç³»ã€‚ç»™å®šä¸€ä¸ª IP ç‰ˆæœ¬ gfx1032ï¼Œä½ èƒ½æ¨æ–­å‡ºä»€ä¹ˆä¿¡æ¯ï¼Ÿ',
            difficulty: 'medium',
            hint: 'ä» IP ç‰ˆæœ¬å·çš„ä¸‰ä¸ªéƒ¨åˆ†ï¼ˆä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·ï¼‰æ¨å¯¼æ¶æ„ä»£æ•°ã€èŠ¯ç‰‡å¤§å°å’Œå¯¹åº”çš„å¸‚åœºäº§å“ã€‚',
            answer: 'gfx1032 çš„è§£æï¼šï¼ˆ1ï¼‰ä¸»ç‰ˆæœ¬ 10 = RDNA ç³»åˆ—ï¼ˆgfx9=GCN5/Vegaï¼Œgfx10=RDNA1/2ï¼Œgfx11=RDNA3ï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œgfx103x = RDNA2ï¼ˆgfx101x=RDNA1ï¼Œgfx110x=RDNA3ï¼‰ã€‚ï¼ˆ2ï¼‰æ¬¡ç‰ˆæœ¬ 3 = RDNA2 çš„ç¬¬ä¸‰ä»£ä¿®è®¢ã€‚ï¼ˆ3ï¼‰ä¿®è®¢å· 2 = è¯¥ä»£ä¸­çš„ç¬¬ä¸‰ä¸ªèŠ¯ç‰‡å˜ä½“ã€‚æŸ¥æ˜ å°„è¡¨ï¼šgfx1030=Navi21ï¼ˆå¤§èŠ¯ç‰‡ï¼ŒRX 6900/6800 XTï¼‰ï¼Œgfx1031=Navi22ï¼ˆRX 6700 XTï¼‰ï¼Œgfx1032=Navi23ï¼ˆRX 6600 XTï¼‰ã€‚æ‰€ä»¥ gfx1032 = Navi23 = RX 6600 XT = RDNA2 ä¸­ç«¯èŠ¯ç‰‡ã€‚åœ¨é©±åŠ¨ä»£ç ä¸­ï¼šCHIP_NAVI23ï¼ŒGFX å®ç°æ–‡ä»¶æ˜¯ gfx_v10_3.cã€‚åœ¨ LLVM ä¸­ï¼š-mcpu=gfx1032ã€‚è¿™ç§æ¨å¯¼èƒ½åŠ›åœ¨é˜…è¯» amdgpu æºç æ—¶éå¸¸æœ‰ç”¨â€”â€”ä½ çœ‹åˆ°ä»»ä½• IP ç‰ˆæœ¬å·éƒ½èƒ½ç«‹å³çŸ¥é“å®ƒå¯¹åº”å“ªä¸ª GPU å’Œå“ªä¸ªæ¶æ„ã€‚',
            amdContext: 'AMD é¢è¯•ä¸­ç»å¸¸ç»™ä½ ä¸€ä¸ª IP ç‰ˆæœ¬å·æˆ–èŠ¯ç‰‡ä»£å·ï¼Œæµ‹è¯•ä½ èƒ½å¦å¿«é€Ÿåæ¨å‡ºå®Œæ•´çš„äº§å“ä¿¡æ¯ã€‚è¿™ä½“ç°äº†ä½ å¯¹ AMD äº§å“çº¿çš„ç†Ÿæ‚‰ç¨‹åº¦ã€‚',
          },
        },
      ],
    },

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Group 0.5.2: Architecture & Driver Stack
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    {
      id: '05-2',
      number: '0.5.2',
      title: 'GPU æ¶æ„æ¼”è¿›ä¸é©±åŠ¨æŠ€æœ¯æ ˆ',
      titleEn: 'Architecture Evolution & Driver Stack',
      icon: 'âš™ï¸',
      description: 'ä» GCN åˆ° RDNA çš„æ¶æ„æ¼”è¿›å†å²ï¼Œä»¥åŠ AMD Linux é©±åŠ¨æŠ€æœ¯æ ˆæ¯ä¸€å±‚çš„èŒè´£å’Œä»£ç ä½ç½®ã€‚',
      lessons: [
        // â”€â”€ Lesson 0.5.2.1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        {
          id: '05-2-1',
          number: '0.5.2.1',
          title: 'GCN åˆ° RDNAï¼šAMD GPU æ¶æ„æ¼”è¿›å²',
          titleEn: 'GCN to RDNA: AMD GPU Architecture History',
          duration: 20,
          difficulty: 'beginner',
          tags: ['GCN', 'RDNA', 'architecture', 'history'],
          concept: {
            summary: 'AMD GPU æ¶æ„ç»å†äº† GCNï¼ˆ2012-2019ï¼‰åˆ° RDNAï¼ˆ2019-è‡³ä»Šï¼‰çš„é‡å¤§è½¬å˜ã€‚GCN æ³¨é‡è®¡ç®—ååé‡ï¼ŒRDNA é‡æ–°è®¾è®¡äº†ç€è‰²å™¨å¼•æ“ä»¥æå‡æ¸¸æˆæ€§èƒ½ã€‚ç†è§£è¿™æ®µå†å²æœ‰åŠ©äºç†è§£ amdgpu ä»£ç ä¸­å¤§é‡ legacy code çš„å­˜åœ¨åŸå› ã€‚',
            explanation: [
              'GCNï¼ˆGraphics Core Nextï¼Œ2012-2019ï¼‰æ˜¯ AMD GPU çš„ç¬¬ä¸€ä¸ªç»Ÿä¸€ç€è‰²å™¨æ¶æ„ï¼Œå¥ å®šäº†ç°ä»£ AMD GPU çš„åŸºç¡€ã€‚GCN çš„è®¾è®¡ç†å¿µæ˜¯"è®¡ç®—ä¼˜å…ˆ"â€”â€”å®ƒçš„ Compute Unitï¼ˆCUï¼‰ç»“æ„éå¸¸é€‚åˆ GPGPU è®¡ç®—ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ AMD åœ¨ HPC é¢†åŸŸæœ‰ç«äº‰åŠ›ï¼‰ï¼Œä½†åœ¨çº¯æ¸¸æˆæ¸²æŸ“æ•ˆç‡ä¸Šä¸å¦‚ NVIDIA çš„åŒä»£æ¶æ„ã€‚GCN ä» 1.0 åˆ° 5.0ï¼ˆVegaï¼‰å…± 5 ä»£ï¼Œåœ¨ amdgpu é©±åŠ¨ä¸­å¯¹åº” gfx6 åˆ° gfx9ã€‚',
              'GCN çš„å…³é”®è®¾è®¡ï¼šï¼ˆ1ï¼‰64-wide Wavefrontâ€”â€”æ¯ä¸ª Wavefront åŒ…å« 64 ä¸ªçº¿ç¨‹ï¼Œåœ¨ 4 ä¸ª SIMD16 å•å…ƒä¸Šæ‰§è¡Œ 4 ä¸ªå‘¨æœŸã€‚è¿™ä¸ªè®¾è®¡åœ¨è®¡ç®—å¯†é›†å‹ä»»åŠ¡ä¸­æ•ˆç‡å¾ˆé«˜ï¼Œä½†åœ¨å›¾å½¢æ¸²æŸ“ä¸­ï¼ˆé€šå¸¸æœ‰å¤§é‡å°ä¸‰è§’å½¢å’Œåˆ†æ”¯ï¼‰ä¼šå¯¼è‡´èµ„æºæµªè´¹ã€‚ï¼ˆ2ï¼‰ç»Ÿä¸€çš„ CU ç»“æ„â€”â€”æ¯ä¸ª CU åŒ…å« 4 ä¸ª SIMD16ã€1 ä¸ªæ ‡é‡å•å…ƒå’Œ 64KB LDSã€‚ï¼ˆ3ï¼‰å›ºå®šçš„ L1/L2 ç¼“å­˜å±‚æ¬¡ã€‚åœ¨é©±åŠ¨ä»£ç ä¸­ï¼ŒGCN çš„å®ç°ä½äº gfx_v6_0.cï¼ˆGCN1ï¼‰åˆ° gfx_v9_0.cï¼ˆVegaï¼‰ã€‚',
              'RDNAï¼ˆRadeon DNAï¼Œ2019-è‡³ä»Šï¼‰æ˜¯ä¸€æ¬¡ä»å¤´è®¾è®¡çš„æ¶æ„é©å‘½ã€‚æ ¸å¿ƒæ”¹å˜ï¼šï¼ˆ1ï¼‰å¼•å…¥ Workgroup Processorï¼ˆWGPï¼‰ç»“æ„â€”â€”ä¸¤ä¸ª CU ç»„æˆä¸€ä¸ª WGPï¼Œå…±äº«æŒ‡ä»¤ç¼“å­˜å’Œ LDS å¸¦å®½ï¼Œå‡å°‘ç¡¬ä»¶å†—ä½™ï¼›ï¼ˆ2ï¼‰æ”¯æŒ Wave32 æ¨¡å¼â€”â€”Wavefront å¯ä»¥æ˜¯ 32 æˆ– 64 çº¿ç¨‹ï¼Œ32 çº¿ç¨‹æ¨¡å¼åœ¨å›¾å½¢æ¸²æŸ“ä¸­æ›´é«˜æ•ˆï¼ˆæ›´å°‘çš„åˆ†æ”¯æµªè´¹ï¼‰ï¼›ï¼ˆ3ï¼‰å®Œå…¨é‡æ–°è®¾è®¡çš„ç¼“å­˜å±‚æ¬¡â€”â€”å¢åŠ äº† L0 ç¼“å­˜ï¼ˆæ¯ä¸ª CU 16KBï¼‰ï¼ŒL1 ç¼“å­˜ä» 16KB å¢åŠ åˆ° 128KBï¼Œä»¥åŠ Infinity Cacheï¼ˆRDNA2/3 çš„å¤§å®¹é‡ L3 ç¼“å­˜ï¼‰ã€‚',
              'RDNA çš„ä¸‰ä¸ªä»£é™…ï¼šRDNA1ï¼ˆ2019ï¼Œgfx10ï¼ŒRX 5700 XTï¼‰å¼•å…¥äº† WGP å’Œ Wave32ï¼›RDNA2ï¼ˆ2020ï¼Œgfx103xï¼ŒRX 6800 XTï¼‰æ·»åŠ äº†ç¡¬ä»¶å…‰çº¿è¿½è¸ªå’Œ Infinity Cacheï¼›RDNA3ï¼ˆ2022ï¼Œgfx110xï¼‰å¼•å…¥äº† WMMAï¼ˆWave Matrix Multiply Accumulateï¼‰ç­‰æ–°èƒ½åŠ›ã€‚RDNA3 å®¶æ—ä¸­æ—¢æœ‰é‡‡ç”¨ Chiplet çš„å‹å·ï¼ˆå¦‚ Navi31/32ï¼‰ï¼Œä¹Ÿæœ‰å•æ™¶ç²’å‹å·ï¼ˆå¦‚ä½ çš„ RX 7600 XT / Navi33ï¼‰ã€‚',
              'å¯¹é©±åŠ¨ä»£ç çš„å½±å“ï¼šamdgpu éœ€è¦åŒæ—¶æ”¯æŒ GCN å’Œ RDNA æ‰€æœ‰æ¶æ„ï¼Œè¿™å¯¼è‡´å¤§é‡æ¡ä»¶ç¼–è¯‘å’Œ IP ç‰ˆæœ¬æ£€æŸ¥ã€‚gfx_v11_0.cï¼ˆä½ çš„ GPUï¼‰å’Œ gfx_v9_0.cï¼ˆVegaï¼‰çš„ä»£ç ç»“æ„ç›¸ä¼¼ä½†ç»†èŠ‚å®Œå…¨ä¸åŒâ€”â€”å¯„å­˜å™¨åœ°å€ã€å‘½ä»¤æ ¼å¼ã€ä¸­æ–­å¤„ç†éƒ½æœ‰å·®å¼‚ã€‚ç†è§£è¿™ä¸ªå†å²æ¼”è¿›ï¼Œèƒ½å¸®åŠ©ä½ åœ¨çœ‹åˆ° "if (adev->ip_versions[GC_HWIP][0] >= IP_VERSION(10, 0, 0))" è¿™ç±»ä»£ç æ—¶ç†è§£å®ƒåœ¨åŒºåˆ† GCN å’Œ RDNAã€‚',
            ],
            keyPoints: [
              'GCN (2012-2019): gfx6-gfx9, 64-wide Wavefront, è®¡ç®—ä¼˜å…ˆè®¾è®¡',
              'RDNA1 (2019): gfx10, å¼•å…¥ WGP å’Œ Wave32, æ¯ç“¦æ€§èƒ½å¤§å¹…æå‡',
              'RDNA2 (2020): gfx103x, ç¡¬ä»¶å…‰çº¿è¿½è¸ª + Infinity Cache',
              'RDNA3 (2022): gfx110x, WMMA AI æŒ‡ä»¤ï¼ˆéƒ¨åˆ†å‹å·ä¸º Chipletï¼ŒNavi33 ä¸ºå•æ™¶ç²’ï¼‰',
              'RDNA4 (2025): gfx120x, å¢å¼ºå…‰è¿½ + AI æ€§èƒ½, RX 9070 XT',
              'amdgpu é©±åŠ¨ä¸­ GCN ä»£ç ä»ç„¶å­˜åœ¨ï¼ˆlegacy supportï¼‰â€”â€”ç†è§£å†å²æœ‰åŠ©äºç†è§£ä»£ç ç»“æ„',
            ],
          },
          diagram: {
            title: 'AMD GPU æ¶æ„æ¼”è¿›æ—¶é—´çº¿',
            content: `AMD GPU æ¶æ„æ¼”è¿›ï¼ˆ2012-2025ï¼‰

2012 â”€â”€â”€ GCN 1.0 (Southern Islands) â”€â”€â”€ gfx6 â”€â”€ HD 7970
         â”‚ é¦–ä¸ªç»Ÿä¸€ç€è‰²å™¨æ¶æ„, 64-wide Wavefront
         â”‚
2013 â”€â”€â”€ GCN 2.0 (Sea Islands) â”€â”€â”€â”€â”€â”€â”€â”€ gfx7 â”€â”€ R9 290X
         â”‚ æ”¹è¿› compute, å¢åŠ  ACE (å¼‚æ­¥è®¡ç®—å¼•æ“)
         â”‚
2015 â”€â”€â”€ GCN 3.0 (Volcanic Islands) â”€â”€â”€ gfx8 â”€â”€ R9 Fury X
         â”‚ é¦–æ¬¡ HBM æ˜¾å­˜, æ”¹è¿› geometry pipeline
         â”‚
2017 â”€â”€â”€ GCN 5.0 (Vega) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ gfx9 â”€â”€ Vega 64
         â”‚ HBM2, æ”¹è¿› HBCC (é«˜å¸¦å®½ç¼“å­˜æ§åˆ¶å™¨)
         â”‚                                          â”‚
  â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â• æ¶æ„é©å‘½ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•
         â”‚                                          â”‚
2019 â”€â”€â”€ RDNA 1.0 (Navi) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ gfx10 â”€â”€ RX 5700 XT
         â”‚ WGP ç»“æ„, Wave32 æ¨¡å¼
         â”‚ æ¯ç“¦æ€§èƒ½æ¯” GCN5 æå‡ 50%
         â”‚
2020 â”€â”€â”€ RDNA 2.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ gfx103x â”€â”€ RX 6800 XT
         â”‚ ç¡¬ä»¶å…‰çº¿è¿½è¸ª (RA), Infinity Cache (128MB)
         â”‚ ä¹Ÿç”¨äº PS5 å’Œ Xbox Series X
         â”‚
2022 â”€â”€â”€ RDNA 3.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ gfx110x â”€â”€ RX 7600 XT â† ä½ 
         â”‚ RDNA3 å®¶æ—ï¼šNavi31/32 ä¸º Chipletï¼ŒNavi33 ä¸ºå•æ™¶ç²’
         â”‚ WMMA AI åŠ é€ŸæŒ‡ä»¤, AV1 ç¡¬ä»¶ç¼–ç 
         â”‚
2025 â”€â”€â”€ RDNA 4.0 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ gfx120x â”€â”€ RX 9070 XT
           å¢å¼ºå…‰è¿½, AI æ€§èƒ½å¤§å¹…æå‡

é©±åŠ¨ä»£ç å¯¹åº”ï¼š
  gfx6  â†’ si_*.c (ä¸åœ¨ amdgpu, åœ¨æ—§çš„ radeon é©±åŠ¨)
  gfx7  â†’ cik_*.c
  gfx8  â†’ vi_*.c
  gfx9  â†’ gfx_v9_0.c, sdma_v4_0.c
  gfx10 â†’ gfx_v10_0.c, sdma_v5_0.c
  gfx11 â†’ gfx_v11_0.c, sdma_v6_0.c â† ä½ çš„ GPU
  gfx12 â†’ gfx_v12_0.c (æœ€æ–°)`,
            caption: 'AMD GPU ä» GCN åˆ° RDNA çš„å®Œæ•´æ¼”è¿›ã€‚2019 å¹´çš„ RDNA1 æ˜¯ä¸€æ¬¡æ¶æ„é©å‘½ï¼Œæ€§èƒ½/ç“¦æå‡äº† 50%ã€‚å›¾ä¸­ä»¥ RX 7600 XT (gfx1102 / Navi33) ä½œä¸ºç¤ºä¾‹ GPU æ ‡æ³¨ï¼Œå…¶ä»– AMD GPU å¯å‚ç…§æ­¤å›¾å®šä½è‡ªå·±çš„ä½ç½®ã€‚',
          },
          codeWalk: {
            title: 'é©±åŠ¨ä»£ç ä¸­çš„æ¶æ„åŒºåˆ†',
            file: 'drivers/gpu/drm/amd/amdgpu/amdgpu_gfx.c',
            language: 'c',
            code: `/* é©±åŠ¨å¦‚ä½•æ ¹æ®æ¶æ„ç‰ˆæœ¬é€‰æ‹©ä¸åŒçš„è¡Œä¸º */

/* 1. æ ¹æ® IP ç‰ˆæœ¬é€‰æ‹© Wave å¤§å° */
static unsigned int amdgpu_gfx_get_wave_size(struct amdgpu_device *adev)
{
    /* RDNA (gfx10+) æ”¯æŒ Wave32 å’Œ Wave64 */
    if (adev->ip_versions[GC_HWIP][0] >= IP_VERSION(10, 0, 0))
        return 32;  /* RDNA é»˜è®¤ Wave32ï¼ˆæ›´é«˜æ•ˆï¼‰ */

    /* GCN (gfx6-gfx9) åªæ”¯æŒ Wave64 */
    return 64;  /* GCN å›ºå®š 64-wide Wavefront */
}

/* 2. RDNA3 ç‰¹æœ‰çš„ WMMA (Wave Matrix Multiply) æ£€æŸ¥ */
bool amdgpu_gfx_has_wmma(struct amdgpu_device *adev)
{
    /* åªæœ‰ gfx11+ (RDNA3) æ”¯æŒ WMMA AI åŠ é€ŸæŒ‡ä»¤ */
    return adev->ip_versions[GC_HWIP][0] >= IP_VERSION(11, 0, 0);
}

/* 3. æ ¹æ®æ¶æ„é€‰æ‹©å¯„å­˜å™¨åç§» */
/* åŒä¸€ä¸ªé€»è¾‘åŠŸèƒ½ï¼ˆå¦‚ GRBM_STATUSï¼‰ï¼Œåœ¨ä¸åŒæ¶æ„ä¸Šçš„
 * å¯„å­˜å™¨åœ°å€å¯èƒ½ä¸åŒï¼š
 *   GCN:  mmGRBM_STATUS = 0x8010
 *   RDNA: mmGRBM_STATUS = 0xD040
 * æ¯ä¸ª gfx_vXX_0.c æ–‡ä»¶å®šä¹‰è‡ªå·±çš„å¯„å­˜å™¨æ˜ å°„ */

/* 4. RDNA3 å®¶æ—ä¸­çš„å®ç°å·®å¼‚ */
/* RDNA3 æ—¢åŒ…å« Chiplet å®ç°ï¼ˆå¦‚ Navi31/32ï¼‰
 * ä¹ŸåŒ…å«å•æ™¶ç²’å®ç°ï¼ˆå¦‚ Navi33ï¼‰ã€‚
 * é©±åŠ¨éœ€è¦æ ¹æ®å…·ä½“ IP/ASIC å¤„ç†å·®å¼‚åŒ–å¯„å­˜å™¨ä¸æ€§èƒ½ç‰¹å¾ã€‚ */`,
            annotations: [
              'IP_VERSION(10, 0, 0) æ˜¯ RDNA1 çš„èµ·ç‚¹â€”â€”è¿™ä¸ªæ£€æŸ¥åŒºåˆ†äº† GCN å’Œ RDNA ä¸¤ä¸ªä¸–ä»£',
              'Wave32 æ˜¯ RDNA çš„å…³é”®åˆ›æ–°â€”â€”åœ¨å›¾å½¢æ¸²æŸ“ä¸­å‡å°‘äº† 50% çš„åˆ†æ”¯æµªè´¹',
              'WMMA æŒ‡ä»¤æ˜¯ RDNA3 ç‹¬æœ‰çš„â€”â€”ç”¨äº AI æ¨ç†ä¸­çš„çŸ©é˜µä¹˜æ³•åŠ é€Ÿ',
              'å¯„å­˜å™¨åœ°å€åœ¨ä¸åŒæ¶æ„ä¹‹é—´ä¸å…¼å®¹â€”â€”æ¯ä»£æœ‰è‡ªå·±çš„å¯„å­˜å™¨å®šä¹‰å¤´æ–‡ä»¶',
              'RDNA3 åœ¨ä¸åŒèŠ¯ç‰‡ä¸Šæœ‰ä¸åŒç‰©ç†å®ç°â€”â€”Navi31/32 ä¸º Chipletï¼ŒNavi33 ä¸ºå•æ™¶ç²’',
            ],
            explanation: 'è¿™æ®µä»£ç å±•ç¤ºäº† amdgpu é©±åŠ¨å¦‚ä½•åœ¨ä¸€å¥—ä»£ç ä¸­å¤„ç†è·¨è¶Š 13 å¹´ã€å¤šä¸ªæ¶æ„ä¸–ä»£çš„ GPUã€‚IP ç‰ˆæœ¬æ£€æŸ¥ï¼ˆIP_VERSION å®ï¼‰æ˜¯æœ€å¸¸ç”¨çš„æ¶æ„åŒºåˆ†æ–¹æ³•ã€‚å½“ä½ åœ¨ä»£ç ä¸­çœ‹åˆ°è¿™ç§æ£€æŸ¥æ—¶ï¼Œä½ å¯ä»¥æ ¹æ®ç‰ˆæœ¬å·åˆ¤æ–­è¿™æ®µä»£ç é’ˆå¯¹çš„æ˜¯å“ªä¸ªæ¶æ„ã€‚',
          },
          miniLab: {
            title: 'å¯¹æ¯”ä¸åŒæ¶æ„çš„ GPU ä¿¡æ¯',
            objective: 'æŸ¥çœ‹ä½ çš„ RDNA3 GPU çš„æ¶æ„ç‰¹æ€§ï¼Œç†è§£å®ƒä¸å‰ä»£æ¶æ„çš„å·®å¼‚ã€‚',
            steps: [
              'æŸ¥çœ‹ GPU æ¶æ„ä¿¡æ¯ï¼šcat /sys/class/drm/card0/device/gpu_metricsï¼ˆå¦‚æœå¯ç”¨ï¼‰',
              'æŸ¥çœ‹ CU æ•°é‡ï¼šdmesg | grep -i "compute unit\\|shader engine\\|cu per"',
              'æŸ¥çœ‹ç¼“å­˜ä¿¡æ¯ï¼šdmesg | grep -i "cache\\|L1\\|L2"',
              'æŸ¥çœ‹ Wave å¤§å°æ”¯æŒï¼šdmesg | grep -i "wave"',
              'æŸ¥çœ‹ IP ç‰ˆæœ¬åˆ—è¡¨ï¼šdmesg | grep -i "ip block"ï¼ˆåˆ—å‡ºæ‰€æœ‰åŠ è½½çš„ IP Block åŠç‰ˆæœ¬ï¼‰',
              'åœ¨å­¦ä¹ æ—¥å¿—ä¸­è®°å½•ä½ çš„ GPU çš„æ¶æ„ç‰¹æ€§ï¼šCU æ•°é‡ã€Wave å¤§å°ã€ç¼“å­˜å±‚æ¬¡',
            ],
            expectedOutput: `RDNA3 (RX 7600 XT) æ¶æ„ç‰¹æ€§ï¼š
- 32 Compute Units (16 WGP)
- Wave32/Wave64 åŒæ¨¡å¼
- L0 Cache: 16KB per CU
- L1 Cache: 128KB per Shader Array
- L2 Cache: 32MB (Infinity Cache)
- VRAM: 8GB GDDR6 @ 288 GB/s
- æ”¯æŒ WMMA AI æŒ‡ä»¤
- Navi33ï¼ˆRX 7600 XTï¼‰ä¸ºå•æ™¶ç²’å®ç°ï¼ˆé Chipletï¼‰`,
            hint: 'å¦‚æœ dmesg ä¿¡æ¯ä¸å¤Ÿè¯¦ç»†ï¼Œå¯ä»¥å®‰è£… rocminfoï¼ˆROCm å·¥å…·ï¼‰ï¼šrocminfo ä¼šè¾“å‡ºéå¸¸è¯¦ç»†çš„ GPU æ¶æ„ä¿¡æ¯ã€‚',
          },
          debugExercise: {
            title: 'è¯†åˆ«æ¶æ„ç›¸å…³çš„ä»£ç é”™è¯¯',
            language: 'c',
            description: 'ä»¥ä¸‹ä»£ç å°è¯•åœ¨æ‰€æœ‰ AMD GPU ä¸Šä½¿ç”¨ WMMA æŒ‡ä»¤ï¼Œä½†åªæœ‰ RDNA3+ æ”¯æŒã€‚',
            question: 'è¿™æ®µä»£ç åœ¨ RDNA2 GPU (RX 6800 XT) ä¸Šä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ',
            buggyCode: `/* ä½¿ç”¨ WMMA æŒ‡ä»¤åŠ é€ŸçŸ©é˜µä¹˜æ³• */
void setup_wmma_compute(struct amdgpu_device *adev)
{
    /* æ²¡æœ‰æ£€æŸ¥ GPU æ˜¯å¦æ”¯æŒ WMMA! */
    WREG32(mmWMMA_CONFIG, WMMA_ENABLE);
    /* åœ¨ RDNA2 GPU ä¸Š: mmWMMA_CONFIG å¯„å­˜å™¨ä¸å­˜åœ¨! */
}`,
            hint: 'WMMA æ˜¯ RDNA3 (gfx11+) æ‰æœ‰çš„åŠŸèƒ½ã€‚åœ¨æ—§æ¶æ„ä¸Šè®¿é—®ä¸å­˜åœ¨çš„å¯„å­˜å™¨ä¼šæ€æ ·ï¼Ÿ',
            answer: 'åœ¨ RDNA2 GPU (gfx1030) ä¸Šï¼ŒWMMA å¯„å­˜å™¨ä¸å­˜åœ¨ã€‚å†™å…¥ä¸å­˜åœ¨çš„ MMIO åœ°å€ä¼šå¯¼è‡´ä¸¤ç§å¯èƒ½ï¼šï¼ˆ1ï¼‰å†™å…¥è¢« PCIe æ€»çº¿å¿½ç•¥ï¼ˆno-opï¼‰ï¼Œä½†åç»­ä¾èµ– WMMA çš„ä»£ç ä¼šäº§ç”Ÿé”™è¯¯ç»“æœï¼›ï¼ˆ2ï¼‰è§¦å‘ GPU çš„ illegal register access ä¸­æ–­ï¼Œå¯¼è‡´ GPU hangã€‚æ­£ç¡®åšæ³•ï¼šåœ¨ä½¿ç”¨ WMMA å‰æ£€æŸ¥æ¶æ„ç‰ˆæœ¬ï¼šif (adev->ip_versions[GC_HWIP][0] >= IP_VERSION(11, 0, 0)) { WREG32(mmWMMA_CONFIG, WMMA_ENABLE); }ã€‚æ›´å¥½çš„åšæ³•æ˜¯ä½¿ç”¨ amdgpu_gfx_has_wmma(adev) è¿™æ ·çš„è¾…åŠ©å‡½æ•°ï¼Œé¿å…åœ¨æ¯ä¸ªè°ƒç”¨ç‚¹é‡å¤ç‰ˆæœ¬æ£€æŸ¥ã€‚è¿™ç§"å…ˆæ£€æŸ¥èƒ½åŠ›å†ä½¿ç”¨åŠŸèƒ½"çš„æ¨¡å¼åœ¨é©±åŠ¨ä»£ç ä¸­æ— å¤„ä¸åœ¨ã€‚',
          },
          interviewQ: {
            question: 'è§£é‡Š AMD GPU ä» GCN åˆ° RDNA çš„æ¶æ„è½¬å˜ï¼Œä»¥åŠè¿™å¯¹ amdgpu é©±åŠ¨ä»£ç çš„å½±å“ã€‚',
            difficulty: 'medium',
            hint: 'ä» Wave å¤§å°ã€CU/WGP ç»“æ„ã€ç¼“å­˜å±‚æ¬¡çš„å˜åŒ–ï¼Œä»¥åŠé©±åŠ¨ä¸­å¤šä»£æ¶æ„å…±å­˜çš„ä»£ç ç®¡ç†æŒ‘æˆ˜æ¥å›ç­”ã€‚',
            answer: 'æ¶æ„è½¬å˜çš„æ ¸å¿ƒï¼šï¼ˆ1ï¼‰æ‰§è¡Œæ¨¡å‹ï¼šGCN å›ºå®š 64-wide Wavefront â†’ RDNA æ”¯æŒ Wave32/64 åŒæ¨¡å¼ã€‚Wave32 åœ¨å›¾å½¢æ¸²æŸ“ä¸­æ›´é«˜æ•ˆï¼ˆå‡å°‘åˆ†æ”¯æµªè´¹ï¼‰ï¼ŒWave64 åœ¨è®¡ç®—ä¸­ä¿æŒååé‡ã€‚é©±åŠ¨éœ€è¦æ ¹æ®å·¥ä½œè´Ÿè½½é€‰æ‹©æ¨¡å¼ã€‚ï¼ˆ2ï¼‰CU ç»“æ„ï¼šGCN çš„ CU æ˜¯ç‹¬ç«‹å•å…ƒ â†’ RDNA çš„ WGPï¼ˆä¸¤ä¸ª CU å…±äº«èµ„æºï¼‰æé«˜äº†ç¡¬ä»¶åˆ©ç”¨ç‡ã€‚é©±åŠ¨çš„è°ƒåº¦é€»è¾‘éœ€è¦é€‚é… WGP ç»“æ„ã€‚ï¼ˆ3ï¼‰ç¼“å­˜å±‚æ¬¡ï¼šGCN ç®€å•çš„ L1/L2 â†’ RDNA å¢åŠ äº† L0ã€æ‰©å¤§ L1ã€å¼•å…¥ Infinity Cacheã€‚é©±åŠ¨çš„å†…å­˜ç®¡ç†ç­–ç•¥éœ€è¦è€ƒè™‘ä¸åŒçš„ç¼“å­˜è¡Œä¸ºã€‚å¯¹é©±åŠ¨ä»£ç çš„å½±å“ï¼šamdgpu ä½¿ç”¨ IP Block æ¶æ„ç®¡ç†å¤šä»£ GPUâ€”â€”æ¯ä»£æ¶æ„æœ‰è‡ªå·±çš„ gfx_vXX_0.c å®ç°æ–‡ä»¶ï¼Œä½†å…±äº«é€šç”¨æ¡†æ¶ï¼ˆamdgpu_gfx.cï¼‰ã€‚IP ç‰ˆæœ¬æ£€æŸ¥ï¼ˆIP_VERSION å®ï¼‰æ˜¯åŒºåˆ†æ¶æ„è¡Œä¸ºçš„ä¸»è¦æœºåˆ¶ã€‚æŒ‘æˆ˜ï¼šGCN å’Œ RDNA çš„å¯„å­˜å™¨åœ°å€ã€å‘½ä»¤æ ¼å¼ã€ä¸­æ–­å¤„ç†å®Œå…¨ä¸åŒï¼Œé©±åŠ¨éœ€è¦ç»´æŠ¤æ•°ç™¾ä¸ªè¿™æ ·çš„å·®å¼‚ç‚¹ã€‚',
            amdContext: 'è¿™æ˜¯ AMD é¢è¯•çš„æ ¸å¿ƒæŠ€æœ¯é—®é¢˜ä¹‹ä¸€ã€‚å±•ç¤ºä½ ä¸ä»…çŸ¥é“æ¶æ„åç§°ï¼Œè¿˜ç†è§£å…·ä½“çš„æŠ€æœ¯å·®å¼‚å’Œå¯¹é©±åŠ¨çš„å½±å“ã€‚',
          },
        },

        // â”€â”€ Lesson 0.5.2.2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        {
          id: '05-2-2',
          number: '0.5.2.2',
          title: 'AMD Linux é©±åŠ¨æŠ€æœ¯æ ˆæ¯ä¸€å±‚è¯¦è§£',
          titleEn: 'AMD Linux Driver Stack Layer by Layer',
          duration: 20,
          difficulty: 'beginner',
          tags: ['driver-stack', 'Mesa', 'libdrm', 'DRM', 'amdgpu', 'ROCm'],
          concept: {
            summary: 'AMD çš„ Linux é©±åŠ¨æŠ€æœ¯æ ˆä»ä¸Šåˆ°ä¸‹åˆ†ä¸º 6 å±‚ï¼šåº”ç”¨ API â†’ Mesa/ROCm â†’ libdrm â†’ DRM Core â†’ amdgpu â†’ GPU ç¡¬ä»¶ã€‚æ¯ä¸€å±‚éƒ½æ˜¯ç‹¬ç«‹çš„ä»£ç ä»“åº“ï¼Œæœ‰ä¸åŒçš„å¼€å‘å›¢é˜Ÿã€ä¸åŒçš„è®¸å¯è¯å’Œä¸åŒçš„å‘å¸ƒèŠ‚å¥ã€‚',
            explanation: [
              'ç†è§£ AMD é©±åŠ¨æŠ€æœ¯æ ˆçš„æ¯ä¸€å±‚æ˜¯é©±åŠ¨å¼€å‘çš„åŸºç¡€ã€‚å½“ä½ é‡åˆ°ä¸€ä¸ª GPU é—®é¢˜æ—¶ï¼Œç¬¬ä¸€æ­¥æ˜¯åˆ¤æ–­é—®é¢˜å‡ºåœ¨å“ªä¸€å±‚â€”â€”è¿™å†³å®šäº†ä½ åº”è¯¥çœ‹å“ªä¸ªä»£ç ä»“åº“ã€è”ç³»å“ªä¸ªå¼€å‘å›¢é˜Ÿã€‚è®©æˆ‘ä»¬ä»ä¸Šåˆ°ä¸‹é€å±‚åˆ†æã€‚',
              'ç¬¬ä¸€å±‚ï¼šå›¾å½¢/è®¡ç®— APIã€‚å›¾å½¢åº”ç”¨ä½¿ç”¨ OpenGLï¼ˆä¼ ç»Ÿï¼‰æˆ– Vulkanï¼ˆç°ä»£ï¼‰APIï¼ŒAI/HPC åº”ç”¨ä½¿ç”¨ HIP APIã€‚è¿™äº›æ˜¯æ ‡å‡†åŒ–çš„æ¥å£ï¼Œä¸ç›´æ¥ä¸ AMD ç¡¬ä»¶äº¤äº’ã€‚å¼€å‘è€…ä¸éœ€è¦å…³å¿ƒåº•å±‚æ˜¯ AMD è¿˜æ˜¯ NVIDIA GPUï¼ŒAPI ä¿è¯äº†å¯ç§»æ¤æ€§ã€‚',
              'ç¬¬äºŒå±‚ï¼šMesa 3D / ROCm è¿è¡Œæ—¶ã€‚Mesaï¼ˆhttps://mesa3d.org/ï¼‰æ˜¯å¼€æºçš„ OpenGL/Vulkan å®ç°ã€‚AMD çš„ Mesa é©±åŠ¨åŒ…æ‹¬ radeonsiï¼ˆOpenGLï¼‰å’Œ radvï¼ˆVulkanï¼‰ã€‚Mesa çš„å·¥ä½œæ˜¯ç¼–è¯‘ç€è‰²å™¨ï¼ˆGLSL/SPIR-V â†’ AMD ISAï¼‰ã€æ„å»º GPU å‘½ä»¤ç¼“å†²åŒºï¼ˆPM4 æ ¼å¼ï¼‰ã€ç®¡ç†ç”¨æˆ·æ€çš„ Buffer åˆ†é…ã€‚ROCm çš„ HIP Runtime åšç±»ä¼¼çš„äº‹ä½†é¢å‘è®¡ç®—â€”â€”é€šè¿‡ HSA Runtime ä¸ KFD é€šä¿¡ã€‚Mesa å’Œ ROCm éƒ½åœ¨ç”¨æˆ·ç©ºé—´è¿è¡Œã€‚',
              'ç¬¬ä¸‰å±‚ï¼šlibdrmã€‚è¿™æ˜¯ç”¨æˆ·ç©ºé—´çš„ C åº“ï¼ˆhttps://gitlab.freedesktop.org/mesa/drmï¼‰ï¼Œå°è£…äº† DRM çš„ ioctl è°ƒç”¨ã€‚libdrm çš„ amdgpu å­åº“ï¼ˆlibdrm_amdgpuï¼‰æä¾›äº† amdgpu_bo_allocï¼ˆåˆ†é… GPU å†…å­˜ï¼‰ã€amdgpu_cs_submitï¼ˆæäº¤å‘½ä»¤ï¼‰ç­‰ APIã€‚Mesa å’Œ ROCm éƒ½ä¾èµ– libdrmã€‚',
              'ç¬¬å››å±‚ï¼šDRM å†…æ ¸æ¡†æ¶ã€‚ä½äº Linux å†…æ ¸çš„ drivers/gpu/drm/drm_*.cã€‚DRM æä¾›é€šç”¨çš„ GPU ç®¡ç†æ¡†æ¶ï¼šè®¾å¤‡æ–‡ä»¶ï¼ˆ/dev/dri/card0ï¼‰ã€ioctl æ¥å£ã€KMSï¼ˆæ˜¾ç¤ºæ¨¡å¼è®¾ç½®ï¼‰ã€GEM/TTMï¼ˆå†…å­˜ç®¡ç†ï¼‰ã€‚DRM æ˜¯æ‰€æœ‰ Linux GPU é©±åŠ¨çš„å…¬å…±ä»£ç â€”â€”AMDã€Intelã€NVIDIA éƒ½ä½¿ç”¨åŒä¸€ä¸ª DRM æ¡†æ¶ã€‚',
              'ç¬¬äº”å±‚ï¼šamdgpu å†…æ ¸é©±åŠ¨ã€‚ä½äº drivers/gpu/drm/amd/ï¼Œè¶…è¿‡ 400 ä¸‡è¡Œä»£ç ã€‚è¿™æ˜¯ AMD GPU ç‰¹å®šçš„å®ç°ï¼ŒåŒ…å«ï¼šGFXï¼ˆå›¾å½¢å¼•æ“æ§åˆ¶ï¼‰ã€SDMAï¼ˆDMA ä¼ è¾“ï¼‰ã€DCï¼ˆDisplay Coreï¼Œæ˜¾ç¤ºæ§åˆ¶ï¼‰ã€VCNï¼ˆè§†é¢‘ç¼–è§£ç ï¼‰ã€KFDï¼ˆROCm è®¡ç®—æ¥å£ï¼‰ã€PM/SMUï¼ˆç”µæºç®¡ç†ï¼‰ã€‚amdgpu æ˜¯ä½ å­¦ä¹ çš„æ ¸å¿ƒå¯¹è±¡ã€‚',
            ],
            keyPoints: [
              'OpenGL/Vulkan/HIP API â†’ åº”ç”¨å±‚æ ‡å‡†æ¥å£ï¼Œè·¨å¹³å°',
              'Mesa radeonsi/radv â†’ ç”¨æˆ·æ€é©±åŠ¨ï¼Œç¼–è¯‘ç€è‰²å™¨å’Œæ„å»ºå‘½ä»¤åŒ…',
              'libdrm (libdrm_amdgpu) â†’ å°è£… ioctlï¼Œæä¾› C API',
              'DRM Core â†’ å†…æ ¸é€šç”¨ GPU æ¡†æ¶ï¼Œæ‰€æœ‰ GPU é©±åŠ¨å…±äº«',
              'amdgpu â†’ AMD ç‰¹å®šå†…æ ¸é©±åŠ¨ï¼ŒIP Block æ¶æ„ï¼Œ400 ä¸‡è¡Œä»£ç ',
              'æ¯å±‚æœ‰ç‹¬ç«‹çš„ä»£ç ä»“åº“ã€å›¢é˜Ÿå’Œå‘å¸ƒå‘¨æœŸ',
            ],
          },
          diagram: {
            title: 'AMD Linux é©±åŠ¨æŠ€æœ¯æ ˆå®Œæ•´åˆ†å±‚',
            content: `AMD Linux é©±åŠ¨æŠ€æœ¯æ ˆï¼šä»£ç ä»“åº“ Ã— å¼€å‘å›¢é˜Ÿ

Layer 6: åº”ç”¨ (Games / AI / Video)
   ä»£ç : åº”ç”¨å¼€å‘è€…
   â†“ OpenGL / Vulkan / HIP / VA-API

Layer 5: ç”¨æˆ·æ€é©±åŠ¨
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚     Mesa 3D         â”‚     ROCm            â”‚
   â”‚  radeonsi (GL)      â”‚  HIP Runtime        â”‚
   â”‚  radv (Vulkan)      â”‚  HSA Runtime        â”‚
   â”‚                     â”‚                     â”‚
   â”‚  ä»“åº“: mesa/mesa    â”‚  ä»“åº“: ROCm/*       â”‚
   â”‚  è®¸å¯: MIT          â”‚  è®¸å¯: MIT          â”‚
   â”‚  å›¢é˜Ÿ: AMD + ç¤¾åŒº   â”‚  å›¢é˜Ÿ: AMD Compute  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ libdrm API                     â†“ KFD ioctl

Layer 4: libdrm
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  libdrm_amdgpu                              â”‚
   â”‚  amdgpu_bo_alloc / amdgpu_cs_submit / ...   â”‚
   â”‚                                              â”‚
   â”‚  ä»“åº“: mesa/drm                              â”‚
   â”‚  è®¸å¯: MIT                                    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“ ioctl() ç³»ç»Ÿè°ƒç”¨

Layer 3: DRM Core (å†…æ ¸ç©ºé—´)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  drm_ioctl.c / drm_gem.c / drm_atomic.c    â”‚
   â”‚  é€šç”¨ GPU ç®¡ç†æ¡†æ¶                           â”‚
   â”‚                                              â”‚
   â”‚  ä»“åº“: torvalds/linux (drivers/gpu/drm/)     â”‚
   â”‚  è®¸å¯: GPL-2.0                                â”‚
   â”‚  å›¢é˜Ÿ: DRM ç»´æŠ¤è€… (Daniel Vetter ç­‰)         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“

Layer 2: amdgpu é©±åŠ¨ (å†…æ ¸ç©ºé—´)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  drivers/gpu/drm/amd/                       â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”‚
   â”‚  â”‚ GFX â”‚ â”‚ SDMA â”‚ â”‚ DC â”‚ â”‚ VCN â”‚ â”‚ KFD â”‚ â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚                                              â”‚
   â”‚  ä»“åº“: torvalds/linux + agd5f/linux          â”‚
   â”‚  è®¸å¯: GPL-2.0                                â”‚
   â”‚  å›¢é˜Ÿ: AMD Markham + Shanghai                â”‚
   â”‚  ç»´æŠ¤è€…: Alex Deucher (agd5f)                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“ MMIO / DMA / Interrupt

Layer 1: GPU ç¡¬ä»¶ (RX 7600 XT / Navi33 / gfx1102)`,
            caption: 'å®Œæ•´çš„ AMD Linux é©±åŠ¨æŠ€æœ¯æ ˆï¼Œæ ‡æ³¨äº†æ¯ä¸€å±‚çš„ä»£ç ä»“åº“ã€è®¸å¯è¯å’Œå¼€å‘å›¢é˜Ÿã€‚å½“ä½ æäº¤ä¸€ä¸ª amdgpu è¡¥ä¸æ—¶ï¼Œå®ƒèµ°çš„è·¯å¾„æ˜¯ï¼šä½  â†’ amd-gfx é‚®ä»¶åˆ—è¡¨ â†’ Alex Deucher Review â†’ drm-next åˆ†æ”¯ â†’ Linus Torvalds çš„ Linux ä¸»çº¿ã€‚',
          },
          codeWalk: {
            title: 'è¿½è¸ªä¸€ä¸ª GPU å†…å­˜åˆ†é…è¯·æ±‚ç©¿è¶Šæ‰€æœ‰å±‚',
            file: 'å¤šå±‚ä»£ç è¿½è¸ª',
            language: 'c',
            code: `/* è¿½è¸ªä¸€ä¸ª BO (Buffer Object) åˆ†é…è¯·æ±‚ç©¿è¶Šé©±åŠ¨æ ˆ */

/* Layer 5: Mesa (ç”¨æˆ·ç©ºé—´) */
/* mesa/src/gallium/winsys/amdgpu/drm/amdgpu_bo.c */
struct pb_buffer *amdgpu_bo_create(...)
{
    /* Mesa éœ€è¦ä¸€å— GPU å†…å­˜æ¥å­˜å‚¨é¡¶ç‚¹æ•°æ® */
    amdgpu_bo_alloc(ws->dev, &request, &buf_handle);
    /* â†“ è°ƒç”¨ libdrm */
}

/* Layer 4: libdrm (ç”¨æˆ·ç©ºé—´) */
/* libdrm/amdgpu/amdgpu_bo.c */
int amdgpu_bo_alloc(amdgpu_device_handle dev,
                     struct amdgpu_bo_alloc_request *alloc,
                     amdgpu_bo_handle *buf_handle)
{
    struct drm_amdgpu_gem_create args = {0};
    args.in.bo_size = alloc->alloc_size;
    args.in.domains = alloc->preferred_heap;

    /* è°ƒç”¨ ioctl â€” è·¨è¶Šç”¨æˆ·/å†…æ ¸è¾¹ç•Œ */
    r = drmIoctl(dev->fd, DRM_IOCTL_AMDGPU_GEM_CREATE, &args);
    /* â†“ ç³»ç»Ÿè°ƒç”¨è¿›å…¥å†…æ ¸ */
}

/* Layer 3: DRM Core (å†…æ ¸ç©ºé—´) */
/* drivers/gpu/drm/drm_ioctl.c */
/* drm_ioctl() â†’ æŸ¥æ‰¾ DRM_IOCTL_AMDGPU_GEM_CREATE
 * â†’ è°ƒç”¨ amdgpu_gem_create_ioctl() */

/* Layer 2: amdgpu (å†…æ ¸ç©ºé—´) */
/* drivers/gpu/drm/amd/amdgpu/amdgpu_gem.c */
int amdgpu_gem_create_ioctl(struct drm_device *dev, void *data,
                             struct drm_file *filp)
{
    /* æœ€ç»ˆè°ƒç”¨ TTM åˆ†é… VRAM æˆ– GTT å†…å­˜ */
    r = amdgpu_gem_object_create(adev, size, alignment,
                                  domain, flags, type, resv, &gobj);
    /* Layer 1: ç¡¬ä»¶ â†’ TTM æ›´æ–° GPU é¡µè¡¨ï¼Œå†…å­˜å¯ç”¨ */
}`,
            annotations: [
              'Mesa çš„ amdgpu_bo_create æ˜¯ç”¨æˆ·æ€çš„å…¥å£â€”â€”å½“æ¸¸æˆéœ€è¦ GPU å†…å­˜æ—¶ä»è¿™é‡Œå¼€å§‹',
              'libdrm çš„ amdgpu_bo_alloc å°è£…äº† ioctl è°ƒç”¨çš„ç»†èŠ‚',
              'drmIoctl æ˜¯ libdrm çš„ç³»ç»Ÿè°ƒç”¨å°è£…â€”â€”è¿™æ˜¯ç”¨æˆ·/å†…æ ¸è¾¹ç•Œçš„è·¨è¶Šç‚¹',
              'drm_ioctl.c çš„åˆ†å‘è¡¨å°† AMDGPU_GEM_CREATE è·¯ç”±åˆ° amdgpu çš„å¤„ç†å‡½æ•°',
              'amdgpu_gem_object_create æ˜¯å®é™…çš„å†…å­˜åˆ†é…â€”â€”é€šè¿‡ TTM ç®¡ç† VRAM/GTT',
              'æ•´ä¸ªè·¯å¾„ï¼šMesa â†’ libdrm â†’ ioctl â†’ DRM â†’ amdgpu â†’ TTM â†’ GPU é¡µè¡¨',
            ],
            explanation: 'è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„ GPU å†…å­˜åˆ†é…å¦‚ä½•ç©¿è¶Šæ•´ä¸ªé©±åŠ¨æ ˆçš„ 5 ä¸ªå±‚æ¬¡ã€‚ä»ç”¨æˆ·ç©ºé—´çš„ Mesa åˆ°å†…æ ¸çš„ amdgpuï¼Œä¸­é—´ç»è¿‡ libdrm çš„ ioctl å°è£…å’Œ DRM çš„åˆ†å‘æœºåˆ¶ã€‚å½“ä½ è°ƒè¯• GPU å†…å­˜é—®é¢˜æ—¶ï¼Œä½ éœ€è¦åˆ¤æ–­é—®é¢˜å‡ºåœ¨å“ªä¸€å±‚â€”â€”æ˜¯ Mesa çš„è¯·æ±‚å‚æ•°é”™è¯¯ï¼Œè¿˜æ˜¯ libdrm çš„ ioctl å°è£…æœ‰ Bugï¼Œè¿˜æ˜¯ amdgpu çš„å†…å­˜ç®¡ç†æœ‰é—®é¢˜ã€‚',
          },
          miniLab: {
            title: 'æŸ¥çœ‹é©±åŠ¨æ ˆæ¯ä¸€å±‚çš„ç‰ˆæœ¬ä¿¡æ¯',
            objective: 'æŸ¥çœ‹ä½ ç³»ç»Ÿä¸Š AMD é©±åŠ¨æ ˆæ¯ä¸€å±‚çš„ç‰ˆæœ¬ï¼Œå»ºç«‹å®Œæ•´çš„ç‰ˆæœ¬æ¡£æ¡ˆã€‚',
            steps: [
              'Mesa ç‰ˆæœ¬ï¼šglxinfo | grep "OpenGL version"',
              'Vulkan é©±åŠ¨ç‰ˆæœ¬ï¼švulkaninfo | grep "driverInfo" | head -1ï¼ˆå¦‚æœå®‰è£…äº† vulkan-toolsï¼‰',
              'libdrm ç‰ˆæœ¬ï¼špkg-config --modversion libdrm_amdgpu',
              'å†…æ ¸ DRM ç‰ˆæœ¬ï¼šcat /sys/module/drm/version',
              'amdgpu é©±åŠ¨ç‰ˆæœ¬ï¼šmodinfo amdgpu | grep "^version"',
              'å†…æ ¸ç‰ˆæœ¬ï¼šuname -r',
            ],
            expectedOutput: `ä½ çš„é©±åŠ¨æ ˆç‰ˆæœ¬æ¡£æ¡ˆï¼ˆç¤ºä¾‹ï¼Œå®é™…ä»¥æœ¬æœºè¾“å‡ºä¸ºå‡†ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mesa         â”‚ <your-mesa-version>           â”‚
â”‚ Vulkan (radv)â”‚ <your-radv-driver-info>       â”‚
â”‚ libdrm       â”‚ <your-libdrm-version>         â”‚
â”‚ DRM Core     â”‚ <your-drm-core-version>       â”‚
â”‚ amdgpu       â”‚ (éšå†…æ ¸ç‰ˆæœ¬)                   â”‚
â”‚ å†…æ ¸         â”‚ <your-kernel-version>          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`,
            hint: 'å¦‚æœ vulkaninfo ä¸å¯ç”¨ï¼Œå®‰è£… vulkan-toolsï¼ˆsudo apt install vulkan-toolsï¼‰ã€‚å¦‚æœ glxinfo ä¸å¯ç”¨ï¼Œå®‰è£… mesa-utilsã€‚',
          },
          debugExercise: {
            title: 'åˆ¤æ–­é”™è¯¯æ¥è‡ªé©±åŠ¨æ ˆçš„å“ªä¸€å±‚',
            language: 'text',
            description: 'ä»¥ä¸‹ 3 ä¸ªé”™è¯¯ä¿¡æ¯æ¥è‡ªé©±åŠ¨æ ˆçš„ä¸åŒå±‚ã€‚åˆ¤æ–­æ¯ä¸ªé”™è¯¯çš„æ¥æºå±‚ã€‚',
            question: 'å°†æ¯ä¸ªé”™è¯¯åŒ¹é…åˆ°æ­£ç¡®çš„å±‚ï¼šMesa / libdrm / DRM Core / amdgpu',
            buggyCode: `é”™è¯¯ 1:
"radv: Failed to create pipeline cache"

é”™è¯¯ 2:
"[drm:amdgpu_cs_ioctl [amdgpu]] *ERROR* Failed to initialize parser"

é”™è¯¯ 3:
"amdgpu_bo_alloc: Cannot allocate memory"`,
            hint: 'æ³¨æ„æ¯ä¸ªé”™è¯¯ä¿¡æ¯çš„å‰ç¼€â€”â€”radv æ˜¯ Mesa çš„ Vulkan é©±åŠ¨ï¼Œ[drm:amdgpu_cs_ioctl] æ˜¯å†…æ ¸ amdgpu çš„æ—¥å¿—æ ¼å¼ï¼Œamdgpu_bo_alloc æ˜¯ libdrm çš„å‡½æ•°ã€‚',
            answer: 'é”™è¯¯ 1 â†’ Mesaï¼ˆradv æ˜¯ Mesa ä¸­ AMD çš„ Vulkan é©±åŠ¨ï¼Œpipeline cache åˆ›å»ºå¤±è´¥é€šå¸¸æ˜¯ç”¨æˆ·æ€é—®é¢˜â€”â€”ç£ç›˜ç©ºé—´ä¸è¶³æˆ– shader cache ç›®å½•æƒé™é—®é¢˜ï¼‰ã€‚é”™è¯¯ 2 â†’ amdgpu å†…æ ¸é©±åŠ¨ï¼ˆ[drm:amdgpu_cs_ioctl [amdgpu]] æ ¼å¼è¡¨æ˜è¿™æ˜¯å†…æ ¸ printk è¾“å‡ºï¼Œamdgpu_cs_ioctl æ˜¯å†…æ ¸çš„å‘½ä»¤æäº¤å¤„ç†å‡½æ•°ï¼Œparser åˆå§‹åŒ–å¤±è´¥é€šå¸¸æ˜¯å‘½ä»¤ç¼“å†²åŒºæ ¼å¼é”™è¯¯ï¼‰ã€‚é”™è¯¯ 3 â†’ libdrmï¼ˆamdgpu_bo_alloc æ˜¯ libdrm çš„å‡½æ•°åï¼Œ"Cannot allocate memory" æ˜¯ ioctl è¿”å› -ENOMEM çš„ç”¨æˆ·æ€é”™è¯¯ä¿¡æ¯ï¼ŒåŸå› æ˜¯ GPU VRAM æˆ– GTT å†…å­˜å·²æ»¡ï¼‰ã€‚å¿«é€Ÿå®šä½å±‚æ¬¡çš„æŠ€å·§ï¼šå†…æ ¸å±‚é”™è¯¯æœ‰ [drm] æˆ– [drm:func] å‰ç¼€ï¼›Mesa å±‚æœ‰ radeonsi/radv å‰ç¼€ï¼›libdrm å±‚æœ‰ amdgpu_ å‡½æ•°åå‰ç¼€ã€‚',
          },
          interviewQ: {
            question: 'æè¿° AMD Linux é©±åŠ¨æ ˆçš„æ¯ä¸€å±‚ï¼Œä»¥åŠå½“ä¸€ä¸ª GPU æ¸²æŸ“ Bug å‡ºç°æ—¶ï¼Œä½ å¦‚ä½•åˆ¤æ–­é—®é¢˜å‡ºåœ¨å“ªä¸€å±‚ã€‚',
            difficulty: 'medium',
            hint: 'ä»å„å±‚èŒè´£å…¥æ‰‹ï¼Œç„¶åæè¿°åˆ†å±‚è°ƒè¯•ç­–ç•¥ï¼šå…ˆç”¨ dmesg æ’é™¤å†…æ ¸å±‚ï¼Œå†ç”¨ apitrace æ’é™¤ Mesa å±‚ã€‚',
            answer: 'é©±åŠ¨æ ˆåˆ†å±‚ï¼šï¼ˆ1ï¼‰åº”ç”¨å±‚ï¼šOpenGL/Vulkan API è°ƒç”¨ï¼›ï¼ˆ2ï¼‰Mesaï¼ˆradeonsi/radvï¼‰ï¼šç€è‰²å™¨ç¼–è¯‘ã€å‘½ä»¤åŒ…æ„å»ºï¼›ï¼ˆ3ï¼‰libdrmï¼ˆlibdrm_amdgpuï¼‰ï¼šioctl å°è£…ï¼›ï¼ˆ4ï¼‰DRM Coreï¼šioctl åˆ†å‘ã€GEM ç®¡ç†ï¼›ï¼ˆ5ï¼‰amdgpuï¼šGPU ç‰¹å®šæ“ä½œã€ç¡¬ä»¶æ§åˆ¶ï¼›ï¼ˆ6ï¼‰GPU ç¡¬ä»¶ã€‚åˆ†å±‚è°ƒè¯•ç­–ç•¥ï¼šï¼ˆ1ï¼‰å…ˆæ£€æŸ¥ dmesgâ€”â€”æœ‰ "[drm] *ERROR*" è¯´æ˜é—®é¢˜åœ¨å†…æ ¸å±‚ï¼ˆamdgpu/DRMï¼‰ï¼›ï¼ˆ2ï¼‰ç”¨ apitrace å½•åˆ¶ GL/VK è°ƒç”¨â€”â€”å¦‚æœ replay èƒ½å¤ç°ï¼Œé—®é¢˜åœ¨ Mesa æˆ–æ›´åº•å±‚ï¼›å¦‚æœä¸èƒ½ï¼Œé—®é¢˜åœ¨åº”ç”¨å±‚ï¼›ï¼ˆ3ï¼‰è¿è¡Œ valgrind æ£€æŸ¥ Mesa çš„ç”¨æˆ·æ€å†…å­˜é”™è¯¯ï¼›ï¼ˆ4ï¼‰ç”¨ RADV_DEBUG=info æˆ– AMD_DEBUG=info è·å– Mesa çš„è¯¦ç»†æ—¥å¿—ï¼›ï¼ˆ5ï¼‰ç”¨ ftrace è¿½è¸ªå†…æ ¸å‡½æ•°è°ƒç”¨é“¾ï¼Œç¡®è®¤ amdgpu ioctl çš„è¿”å›å€¼ï¼›ï¼ˆ6ï¼‰æœ€ç»ˆç”¨ umr è¯»å– GPU å¯„å­˜å™¨çŠ¶æ€ç¡®è®¤ç¡¬ä»¶è¡Œä¸ºã€‚è¿™ç§è‡ªä¸Šè€Œä¸‹çš„æ’é™¤æ³•æ˜¯æœ€é«˜æ•ˆçš„è°ƒè¯•ç­–ç•¥ã€‚',
            amdContext: 'AMD é¢è¯•ä¸­ç»å¸¸ä»¥"å¦‚ä½•è°ƒè¯•ä¸€ä¸ªæ¸²æŸ“ Bug"ä¸ºé¢˜ï¼Œæµ‹è¯•ä½ å¯¹æ•´ä¸ªæ ˆçš„ç†è§£å’Œç³»ç»ŸåŒ–çš„è°ƒè¯•æ€ç»´ã€‚',
          },
        },

        // â”€â”€ Lesson 0.5.2.3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        {
          id: '05-2-3',
          number: '0.5.2.3',
          title: 'AMD å¼€æºç¤¾åŒºä¸ç«äº‰æ ¼å±€',
          titleEn: 'AMD Open Source Community & Competitive Landscape',
          duration: 15,
          difficulty: 'beginner',
          tags: ['open-source', 'community', 'amd-gfx', 'NVIDIA', 'Intel'],
          concept: {
            summary: 'AMD çš„ amd-gfx é‚®ä»¶åˆ—è¡¨æ˜¯é©±åŠ¨å¼€å‘çš„æ ¸å¿ƒåä½œå¹³å°ï¼Œæ¯å¤© 30-50 ä¸ªè¡¥ä¸ã€‚ç†è§£ç¤¾åŒºå·¥ä½œæµç¨‹å’Œç«äº‰æ ¼å±€ï¼Œæ˜¯èŒä¸šå‘å±•çš„é‡è¦èƒŒæ™¯çŸ¥è¯†ã€‚',
            explanation: [
              'AMD çš„ GPU é©±åŠ¨å¼€å‘ä»¥ amd-gfx@lists.freedesktop.org é‚®ä»¶åˆ—è¡¨ä¸ºä¸­å¿ƒã€‚è¿™ä¸ªé‚®ä»¶åˆ—è¡¨æ˜¯å…¬å¼€çš„â€”â€”ä»»ä½•äººéƒ½å¯ä»¥è®¢é˜…å’Œå‘é€è¡¥ä¸ã€‚æ¯å¤©æœ‰ 30-50 ä¸ªè¡¥ä¸æäº¤ï¼Œæ¶µç›– Bug ä¿®å¤ã€æ–°ç¡¬ä»¶æ”¯æŒã€æ€§èƒ½ä¼˜åŒ–ã€ä»£ç æ¸…ç†ç­‰ã€‚Alex Deucherï¼ˆagd5fï¼‰æ˜¯ amdgpu çš„é¦–å¸­ç»´æŠ¤è€…ï¼Œå‡ ä¹æ¯ä¸ªè¡¥ä¸éƒ½ç»è¿‡ä»–çš„ Reviewã€‚',
              'AMD çš„é©±åŠ¨å¼€å‘æµç¨‹ï¼šå¼€å‘è€…ï¼ˆAMD å†…éƒ¨æˆ–å¤–éƒ¨ç¤¾åŒºï¼‰åœ¨ amd-gfx åˆ—è¡¨å‘é€è¡¥ä¸ â†’ Alex Deucher å’Œå…¶ä»–ç»´æŠ¤è€… Review â†’ é€šè¿‡çš„è¡¥ä¸è¿›å…¥ AMD çš„ drm-next åˆ†æ”¯ï¼ˆagd5f/linux on gitlab.freedesktop.orgï¼‰â†’ drm-next å®šæœŸåˆå¹¶åˆ° Dave Airlie çš„ drm-next â†’ æœ€ç»ˆåˆå¹¶åˆ° Linus çš„ Linux ä¸»çº¿ã€‚ä»è¡¥ä¸å‘é€åˆ°åˆå¹¶è¿›ä¸»çº¿é€šå¸¸éœ€è¦ 1-3 ä¸ªå†…æ ¸ release cycleï¼ˆ3-9 ä¸ªæœˆï¼‰ã€‚',
              'AMD vs NVIDIA çš„å¼€æºæˆ˜ç•¥å¯¹æ¯”ï¼šAMD çš„å®Œå…¨å¼€æºç­–ç•¥è®©ç¤¾åŒºå¯ä»¥è‡ªç”±è´¡çŒ®â€”â€”ç›®å‰æœ‰æ•°ç™¾åé AMD å‘˜å·¥ä¸º amdgpu æäº¤è¿‡è¡¥ä¸ã€‚NVIDIA åœ¨ 2022 å¹´å¼€æºäº† nvidia-open å†…æ ¸æ¨¡å—ï¼Œä½†æ ¸å¿ƒå›ºä»¶å’Œç”¨æˆ·æ€é©±åŠ¨ä»ç„¶é—­æºã€‚è¿™æ„å‘³ç€ç¤¾åŒºå¯¹ NVIDIA é©±åŠ¨çš„å½±å“åŠ›æä¸ºæœ‰é™â€”â€”ä½ ä¸èƒ½ä¸º NVIDIA çš„æ ¸å¿ƒé©±åŠ¨æäº¤è¡¥ä¸ã€‚Intel çš„ç­–ç•¥ç±»ä¼¼ AMDï¼ˆå®Œå…¨å¼€æºï¼‰ï¼Œä½†å…¶ç‹¬ç«‹ GPU å¸‚åœºä»½é¢å°å¾—å¤šã€‚',
              'AMD åœ¨ä¸­å›½çš„å¼€å‘ä¸­å¿ƒï¼šAMD ä¸Šæµ·åŠå…¬å®¤ä¹Ÿæœ‰ GPU é©±åŠ¨å›¢é˜Ÿï¼Œå‚ä¸ amdgpu é©±åŠ¨çš„å¼€å‘ã€‚åœ¨ amd-gfx é‚®ä»¶åˆ—è¡¨ä¸­ç»å¸¸å¯ä»¥çœ‹åˆ° @amd.com é‚®ç®±ä¸­æ¥è‡ªä¸­å›½å¼€å‘è€…çš„è¡¥ä¸ã€‚å¦‚æœä½ åœ¨ä¸­å›½æ±‚èŒ AMD GPU é©±åŠ¨å²—ä½ï¼Œä¸Šæµ·æ˜¯ä¸»è¦çš„å·¥ä½œåœ°ç‚¹ã€‚',
            ],
            keyPoints: [
              'amd-gfx é‚®ä»¶åˆ—è¡¨æ˜¯å…¬å¼€çš„ï¼Œæ¯å¤© 30-50 ä¸ªè¡¥ä¸ï¼Œä»»ä½•äººå¯ä»¥å‚ä¸',
              'Alex Deucher (agd5f) æ˜¯ amdgpu é¦–å¸­ç»´æŠ¤è€…ï¼Œå‡ ä¹ Review æ‰€æœ‰è¡¥ä¸',
              'è¡¥ä¸è·¯å¾„ï¼šamd-gfx â†’ drm-next (AMD) â†’ drm-next (Dave Airlie) â†’ Linux ä¸»çº¿',
              'AMD å®Œå…¨å¼€æº vs NVIDIA æ ¸å¿ƒé—­æº vs Intel å®Œå…¨å¼€æºä½†å¸‚åœºä»½é¢å°',
              'AMD ä¸Šæµ·åŠå…¬å®¤æœ‰ GPU é©±åŠ¨å›¢é˜Ÿï¼Œä¸ Markham åä½œ',
              'æäº¤ä¸€ä¸ªè¢«æ¥å—çš„è¡¥ä¸æ˜¯è¿›å…¥ AMD æœ€æœ‰åŠ›çš„ç®€å†è¯æ˜',
            ],
          },
          diagram: {
            title: 'AMD é©±åŠ¨è¡¥ä¸ä»å¼€å‘è€…åˆ° Linux ä¸»çº¿çš„è·¯å¾„',
            content: `AMD é©±åŠ¨è¡¥ä¸çš„ç”Ÿå‘½å‘¨æœŸ

ä½  (å¼€å‘è€…)
  â”‚
  â”‚ git send-email patch.mbox
  â–¼
amd-gfx@lists.freedesktop.org       â† å…¬å¼€é‚®ä»¶åˆ—è¡¨
  â”‚
  â”‚ Alex Deucher Review
  â”‚ (é€šå¸¸ 1-2 å‘¨)
  â–¼
AMD drm-next åˆ†æ”¯                    â† agd5f/linux on GitLab
  â”‚ (gitlab.freedesktop.org/agd5f/linux)
  â”‚
  â”‚ æ¯ 2-4 å‘¨ pull request
  â–¼
DRM drm-next åˆ†æ”¯                    â† Dave Airlie ç»´æŠ¤
  â”‚ (drm/drm on GitLab)
  â”‚
  â”‚ æ¯ä¸ª merge window
  â–¼
Linus Torvalds / Linux ä¸»çº¿          â† torvalds/linux
  â”‚
  â”‚ å‘å¸ƒ rc1 â†’ rc2 â†’ ... â†’ release
  â–¼
Linux 6.X æ­£å¼å‘å¸ƒ                   â† ä½ çš„è¡¥ä¸åœ¨è¿™é‡Œï¼

æ—¶é—´çº¿ï¼š
  è¡¥ä¸å‘é€ â”€â”€â†’ Review (1-2å‘¨) â”€â”€â†’ drm-next (2-4å‘¨)
  â”€â”€â†’ ä¸»çº¿ merge window (2-3æœˆ) â”€â”€â†’ æ­£å¼å‘å¸ƒ

å¹¶è¡Œè·¯å¾„ï¼ˆAMD å†…éƒ¨ï¼‰ï¼š
  AMD å·¥ç¨‹å¸ˆ â†’ å†…éƒ¨ Review â†’ amd-gfx â†’ åŒæ ·çš„æµç¨‹`,
            caption: 'ä¸€ä¸ª amdgpu è¡¥ä¸ä»å¼€å‘è€…é”®ç›˜åˆ° Linux æ­£å¼å‘å¸ƒçš„å®Œæ•´è·¯å¾„ã€‚æ•´ä¸ªè¿‡ç¨‹å…¬å¼€é€æ˜â€”â€”ä½ å¯ä»¥åœ¨é‚®ä»¶åˆ—è¡¨ä¸­çœ‹åˆ°æ¯ä¸€æ­¥ã€‚',
          },
          codeWalk: {
            title: 'é˜…è¯»ä¸€ä¸ªçœŸå®çš„ amd-gfx è¡¥ä¸ Review å¯¹è¯',
            file: 'amd-gfx mailing list (ç¤ºä¾‹)',
            language: 'text',
            code: `Subject: [PATCH v2] drm/amdgpu: fix use-after-free in amdgpu_ctx_fini
From: Developer <dev@company.com>

[v2: address Alex's review comments - add null check before kfree]

When a context is destroyed while a job is still pending,
amdgpu_ctx_fini() may access the context structure after
it has been freed by the job completion handler.

Add a reference count check before accessing the context
to prevent use-after-free.

Fixes: abc123 ("drm/amdgpu: add context reference counting")
Cc: stable@vger.kernel.org
Signed-off-by: Developer <dev@company.com>
---
 .../gpu/drm/amd/amdgpu/amdgpu_ctx.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

---
# Review å¯¹è¯ï¼ˆè¡¥ä¸ä¸‹é¢çš„é‚®ä»¶å›å¤ï¼‰ï¼š

> Alex Deucher <alexander.deucher@amd.com>:
> 
> On Mon, Jan 20, 2025, Developer wrote:
> > +  if (!kref_get_unless_zero(&ctx->refcount))
> > +      return;
>
> Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
> 
> Thanks for fixing this. I'll pick this up for 6.9.

# è¡¥ä¸è¢«æ¥å—ï¼è¿›å…¥ drm-nextã€‚`,
            annotations: [
              '[PATCH v2] è¡¨ç¤ºè¿™æ˜¯ç¬¬äºŒç‰ˆâ€”â€”ç¬¬ä¸€ç‰ˆæ”¶åˆ° Review æ„è§åä¿®æ”¹äº†',
              'Fixes: æ ‡ç­¾å¼•ç”¨å¼•å…¥ Bug çš„åŸå§‹æäº¤ï¼Œå¸®åŠ©è‡ªåŠ¨ backport åˆ°ç¨³å®šåˆ†æ”¯',
              'Cc: stable@vger.kernel.org è¯·æ±‚å°†ä¿®å¤ backport åˆ° LTS å†…æ ¸',
              'Reviewed-by: Alex Deucher è¡¨ç¤ºé¦–å¸­ç»´æŠ¤è€…å·²å®¡æŸ¥å¹¶åŒæ„',
              '"I\'ll pick this up for 6.9" è¡¨ç¤ºè¡¥ä¸å°†è¿›å…¥ä¸‹ä¸€ä¸ªå†…æ ¸ç‰ˆæœ¬',
              'æ•´ä¸ªå¯¹è¯æ˜¯å…¬å¼€çš„â€”â€”ä»»ä½•äººéƒ½èƒ½åœ¨é‚®ä»¶åˆ—è¡¨å½’æ¡£ä¸­æŸ¥çœ‹',
            ],
            explanation: 'è¿™å°±æ˜¯ AMD é©±åŠ¨å¼€å‘çš„çœŸå®å·¥ä½œæµç¨‹ã€‚æ³¨æ„å‡ ä¸ªå…³é”®ç‚¹ï¼šï¼ˆ1ï¼‰è¡¥ä¸çš„ commit message æ¸…æ¥šåœ°è§£é‡Šäº† what å’Œ whyï¼›ï¼ˆ2ï¼‰v2 è¯´æ˜å¼€å‘è€…è®¤çœŸå›åº”äº† Review æ„è§ï¼›ï¼ˆ3ï¼‰Alex Deucher çš„ Reviewed-by æ˜¯è¡¥ä¸è¢«æ¥å—çš„æœ€ç»ˆç¡®è®¤ã€‚å½“ä½ å‡†å¤‡æäº¤ä½ çš„ç¬¬ä¸€ä¸ªè¡¥ä¸æ—¶ï¼Œå‚è€ƒè¿™ä¸ªæ ¼å¼ã€‚',
          },
          miniLab: {
            title: 'æ¢ç´¢ amd-gfx é‚®ä»¶åˆ—è¡¨',
            objective: 'è®¢é˜… amd-gfx é‚®ä»¶åˆ—è¡¨ï¼Œæµè§ˆæœ€è¿‘çš„è¡¥ä¸ï¼Œæ„Ÿå— AMD é©±åŠ¨å¼€å‘ç¤¾åŒºçš„æ´»è·ƒåº¦ã€‚',
            steps: [
              'æ‰“å¼€ https://lists.freedesktop.org/mailman/listinfo/amd-gfx',
              'æµè§ˆæœ€è¿‘ä¸€ä¸ªæœˆçš„å½’æ¡£ï¼šhttps://lists.freedesktop.org/archives/amd-gfx/',
              'æ‰¾åˆ°ä¸€ä¸ª [PATCH] å¼€å¤´çš„é‚®ä»¶ï¼Œé˜…è¯» commit message',
              'æ‰¾åˆ°ä¸€ä¸ªæœ‰ Review å›å¤çš„è¡¥ä¸çº¿ç¨‹ï¼Œè§‚å¯Ÿ Review è¿‡ç¨‹',
              'ç»Ÿè®¡ä»Šå¤©çš„è¡¥ä¸æ•°é‡ï¼šæµè§ˆä»Šå¤©çš„å½’æ¡£ï¼Œæ•°æ•°æœ‰å¤šå°‘ [PATCH] é‚®ä»¶',
              'ï¼ˆå¯é€‰ï¼‰è®¢é˜…é‚®ä»¶åˆ—è¡¨ï¼šåœ¨ä¸Šé¢çš„é“¾æ¥ä¸­å¡«å†™ä½ çš„é‚®ç®±åœ°å€',
            ],
            expectedOutput: `è§‚å¯Ÿåˆ°çš„æ´»è·ƒåº¦ï¼š
- æ¯å¤©çº¦ 30-50 å°é‚®ä»¶ï¼ˆè¡¥ä¸ + Review å›å¤ï¼‰
- è¡¥ä¸ä¸»é¢˜å‰ç¼€æ ¼å¼ï¼šdrm/amd/display:, drm/amdgpu:, drm/amdkfd:
- å¸¸è§ Reviewerï¼šAlex Deucher, Harry Wentland, Mario Limonciello
- è¡¥ä¸å¤§å°ï¼šå¤§éƒ¨åˆ†æ˜¯ 10-100 è¡Œçš„å°æ”¹åŠ¨`,
            hint: 'å¦‚æœä¸æƒ³è¢«é‚®ä»¶æ·¹æ²¡ï¼Œå¯ä»¥é€‰æ‹© Digest æ¨¡å¼ï¼ˆæ¯å¤©æ”¶åˆ°ä¸€å°æ±‡æ€»é‚®ä»¶è€Œä¸æ˜¯æ¯å°å•ç‹¬å‘é€ï¼‰ã€‚',
          },
          debugExercise: {
            title: 'åˆ¤æ–­ GPU é©±åŠ¨çš„å¼€æº/é—­æºç»„ä»¶',
            language: 'text',
            description: 'ä»¥ä¸‹åˆ—å‡ºäº† AMD å’Œ NVIDIA é©±åŠ¨æ ˆçš„ 6 ä¸ªç»„ä»¶ã€‚æ ‡è®°æ¯ä¸ªä¸ºå¼€æºæˆ–é—­æºã€‚',
            question: 'æ ‡è®°æ¯ä¸ªç»„ä»¶çš„å¼€æºçŠ¶æ€',
            buggyCode: `AMD ä¾§ï¼š
1. amdgpu å†…æ ¸é©±åŠ¨                          â†’ ???
2. Mesa radv (Vulkan é©±åŠ¨)                  â†’ ???
3. AMD GPU å›ºä»¶ (amdgpu firmware blobs)     â†’ ???

NVIDIA ä¾§ï¼š
4. nvidia å†…æ ¸é©±åŠ¨ (ä¼ ç»Ÿé—­æºç‰ˆ)             â†’ ???
5. nvidia-open å†…æ ¸æ¨¡å—                     â†’ ???
6. NVIDIA ç”¨æˆ·æ€é©±åŠ¨ (libGL/libcuda)        â†’ ???`,
            hint: 'AMD å‡ ä¹å…¨éƒ¨å¼€æºï¼ˆå›ºä»¶é™¤å¤–ï¼‰ï¼ŒNVIDIA çš„æ ¸å¿ƒä»ç„¶é—­æºã€‚',
            answer: '1. amdgpu â†’ å¼€æº (GPL-2.0)ï¼Œåˆå¹¶å…¥ Linux ä¸»çº¿ã€‚2. Mesa radv â†’ å¼€æº (MIT)ï¼Œåœ¨ Mesa ä»“åº“ä¸­ã€‚3. AMD GPU å›ºä»¶ â†’ é—­æºï¼ˆä½œä¸º binary blob åœ¨ linux-firmware ä¸­å‘å¸ƒï¼Œæ¥å— AMD è®¸å¯åè®®ï¼‰ã€‚4. nvidia ä¼ ç»Ÿé©±åŠ¨ â†’ é—­æºï¼ˆNVIDIA è‡ªè¡Œå‘å¸ƒçš„ .run å®‰è£…åŒ…ï¼‰ã€‚5. nvidia-open â†’ éƒ¨åˆ†å¼€æºï¼ˆ2022 å¹´å¼€æºçš„å†…æ ¸æ¨¡å—ï¼Œä½†ä»…åŒ…å« GPU System Processor ä»£ç ï¼Œæ ¸å¿ƒè®¡ç®—/å›¾å½¢é€»è¾‘ä»åœ¨é—­æºçš„ GPU System Processor å›ºä»¶ä¸­ï¼‰ã€‚6. NVIDIA ç”¨æˆ·æ€é©±åŠ¨ â†’ é—­æºï¼ˆlibGL.soã€libcuda.so å®Œå…¨é—­æºï¼‰ã€‚å…³é”®åŒºåˆ«ï¼šAMD çš„æ•´ä¸ªè½¯ä»¶æ ˆï¼ˆé©±åŠ¨+Mesa+ROCmï¼‰éƒ½æ˜¯å¼€æºçš„ï¼Œåªæœ‰å›ºä»¶æ˜¯ binary blobã€‚NVIDIA çš„æ ¸å¿ƒé©±åŠ¨ï¼ˆæ— è®ºå†…æ ¸æ€è¿˜æ˜¯ç”¨æˆ·æ€ï¼‰éƒ½æ˜¯é—­æºçš„ï¼Œnvidia-open åªæ˜¯ä¸€ä¸ªè–„å£³ã€‚',
          },
          interviewQ: {
            question: 'AMD çš„ amdgpu é©±åŠ¨æ˜¯å¦‚ä½•åˆå¹¶åˆ° Linux å†…æ ¸ä¸»çº¿çš„ï¼Ÿæè¿°ä»è¡¥ä¸æäº¤åˆ°æœ€ç»ˆå‘å¸ƒçš„å®Œæ•´æµç¨‹ã€‚',
            difficulty: 'easy',
            hint: 'æè¿°é‚®ä»¶åˆ—è¡¨ â†’ Review â†’ drm-next â†’ merge window â†’ release çš„è·¯å¾„ã€‚',
            answer: 'å®Œæ•´æµç¨‹ï¼šï¼ˆ1ï¼‰å¼€å‘è€…ï¼ˆAMD å·¥ç¨‹å¸ˆæˆ–ç¤¾åŒºè´¡çŒ®è€…ï¼‰åœ¨æœ¬åœ°å¼€å‘å¹¶æµ‹è¯•è¡¥ä¸ï¼›ï¼ˆ2ï¼‰ä½¿ç”¨ git send-email å°†è¡¥ä¸å‘é€åˆ° amd-gfx@lists.freedesktop.org é‚®ä»¶åˆ—è¡¨ï¼›ï¼ˆ3ï¼‰AMD ç»´æŠ¤è€…ï¼ˆä¸»è¦æ˜¯ Alex Deucherï¼‰å’Œå…¶ä»–ç¤¾åŒºæˆå‘˜ Review è¡¥ä¸ï¼Œç»™å‡º Reviewed-by æˆ–ä¿®æ”¹æ„è§ï¼›ï¼ˆ4ï¼‰é€šè¿‡ Review çš„è¡¥ä¸è¿›å…¥ Alex Deucher ç»´æŠ¤çš„ amd-staging-drm-next åˆ†æ”¯ï¼ˆGit ä»“åº“åœ¨ gitlab.freedesktop.org/agd5f/linuxï¼‰ï¼›ï¼ˆ5ï¼‰Alex å®šæœŸå‘ Dave Airlieï¼ˆDRM å­ç³»ç»Ÿç»´æŠ¤è€…ï¼‰å‘é€ pull requestï¼Œå°†è¡¥ä¸åˆå¹¶åˆ° drm-next åˆ†æ”¯ï¼›ï¼ˆ6ï¼‰åœ¨ Linux å†…æ ¸çš„ merge windowï¼ˆæ¯ä¸ª release cycle çš„å‰ä¸¤å‘¨ï¼‰æœŸé—´ï¼ŒDave Airlie å‘ Linus Torvalds å‘é€ pull requestï¼›ï¼ˆ7ï¼‰è¡¥ä¸è¿›å…¥ Linus çš„ Linux ä¸»çº¿ï¼Œç»è¿‡ rc1-rc7 çš„æµ‹è¯•å‘¨æœŸåæ­£å¼å‘å¸ƒã€‚ç´§æ€¥ Bug ä¿®å¤å¯ä»¥é€šè¿‡ Cc: stable@vger.kernel.org æ ‡ç­¾è¯·æ±‚ backport åˆ° LTS å†…æ ¸ã€‚',
            amdContext: 'ç†è§£è¿™ä¸ªæµç¨‹å±•ç¤ºäº†ä½ å¯¹ Linux å†…æ ¸ç¤¾åŒºå·¥ä½œæ–¹å¼çš„ç†è§£â€”â€”è¿™æ˜¯ AMD é¢è¯•çš„åŠ åˆ†é¡¹ã€‚',
          },
        },
      ],
    },
  ],
  completionChecklist: [
    'èƒ½åŒºåˆ† AMD ä¸‰ä¸ª GPU äº§å“å±‚æ¬¡ï¼ˆRadeon RX / Pro / Instinctï¼‰åŠå…¶é©±åŠ¨å·®å¼‚',
    'èƒ½ä»å¸‚åœºåæ¨å¯¼å‡ºèŠ¯ç‰‡ä»£å·ã€IP ç‰ˆæœ¬å’Œ Device IDï¼ˆRX 7600 XT â†” Navi33 â†” gfx1102 â†” 0x7480ï¼‰',
    'èƒ½è§£é‡Š GCN åˆ° RDNA çš„æ¶æ„è½¬å˜åŠå…¶å¯¹é©±åŠ¨ä»£ç çš„å½±å“',
    'èƒ½æè¿° AMD é©±åŠ¨æ ˆçš„æ¯ä¸€å±‚åŠå…¶ä»£ç ä»“åº“ä½ç½®',
    'èƒ½å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªé”™è¯¯ä¿¡æ¯æ¥è‡ªé©±åŠ¨æ ˆçš„å“ªä¸€å±‚',
    'äº†è§£ amd-gfx é‚®ä»¶åˆ—è¡¨çš„å·¥ä½œæµç¨‹å’Œè¡¥ä¸åˆå¹¶è·¯å¾„',
  ],
};
